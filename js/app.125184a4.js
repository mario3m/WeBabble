(function(e){function n(n){for(var a,r,i=n[0],c=n[1],u=n[2],l=0,f=[];l<i.length;l++)r=i[l],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&f.push(s[r][0]),s[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);g&&g(n);while(f.length)f.shift()();return o.push.apply(o,u||[]),t()}function t(){for(var e,n=0;n<o.length;n++){for(var t=o[n],a=!0,r=1;r<t.length;r++){var i=t[r];0!==s[i]&&(a=!1)}a&&(o.splice(n--,1),e=c(c.s=t[0]))}return e}var a={},r={app:0},s={app:0},o=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-118d6538":"d5e695b1","chunk-21399466":"d2baad11","chunk-3179424c":"eb62070a","chunk-01635386":"5df7cc92","chunk-622f8ab8":"06c6d001","chunk-2733c950":"7a9d2161","chunk-5cab18be":"0ed64829","chunk-68580884":"9d91c237","chunk-7db6e6a6":"b4781b64","chunk-1dcec364":"35779172","chunk-2d258260":"b7d94867","chunk-4b03be8b":"dd01036d","chunk-797e9352":"61d5ec52","chunk-a1b665b8":"cbe0d6c0","chunk-116beaae":"2ef89bab","chunk-56a2defe":"1681b1d1","chunk-e2d880e8":"29e0faf3","chunk-aa931dea":"95379bf5","chunk-04be79f4":"eefa81f8","chunk-1cf5cb4e":"1d97b67a","chunk-21f06558":"55c71388","chunk-53e063b5":"a9a50317","chunk-6872e3c0":"9ac52cfc","chunk-d7d1cc78":"2bb2612f","chunk-0c346784":"639deba4","chunk-3dc88c82":"f7d73373","chunk-0a1d012c":"1b8310f7","chunk-2939ac1d":"edcd48a5","chunk-8956f106":"f5f9e66c"}[e]+".js"}function c(n){if(a[n])return a[n].exports;var t=a[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,c),t.l=!0,t.exports}c.e=function(e){var n=[],t={"chunk-118d6538":1,"chunk-21399466":1,"chunk-3179424c":1,"chunk-01635386":1,"chunk-622f8ab8":1,"chunk-2733c950":1,"chunk-5cab18be":1,"chunk-68580884":1,"chunk-7db6e6a6":1,"chunk-1dcec364":1,"chunk-2d258260":1,"chunk-4b03be8b":1,"chunk-797e9352":1,"chunk-a1b665b8":1,"chunk-116beaae":1,"chunk-56a2defe":1,"chunk-e2d880e8":1,"chunk-aa931dea":1,"chunk-04be79f4":1,"chunk-1cf5cb4e":1,"chunk-21f06558":1,"chunk-53e063b5":1,"chunk-6872e3c0":1,"chunk-d7d1cc78":1,"chunk-0c346784":1,"chunk-3dc88c82":1,"chunk-0a1d012c":1,"chunk-2939ac1d":1,"chunk-8956f106":1};r[e]?n.push(r[e]):0!==r[e]&&t[e]&&n.push(r[e]=new Promise((function(n,t){for(var a="css/"+({}[e]||e)+"."+{"chunk-118d6538":"803f1308","chunk-21399466":"3ba233f1","chunk-3179424c":"15fc8d6e","chunk-01635386":"fa14cca6","chunk-622f8ab8":"dc35a825","chunk-2733c950":"df0fdab8","chunk-5cab18be":"df0fdab8","chunk-68580884":"f7729ee3","chunk-7db6e6a6":"6a1f38e1","chunk-1dcec364":"b69ea1e5","chunk-2d258260":"2f06dff4","chunk-4b03be8b":"7268b89c","chunk-797e9352":"aa5f8c7b","chunk-a1b665b8":"4551a332","chunk-116beaae":"8cea3ea7","chunk-56a2defe":"84291cb1","chunk-e2d880e8":"8cea3ea7","chunk-aa931dea":"0c960def","chunk-04be79f4":"efb69371","chunk-1cf5cb4e":"df0fdab8","chunk-21f06558":"c7210f2c","chunk-53e063b5":"63af7332","chunk-6872e3c0":"8cea3ea7","chunk-d7d1cc78":"ad65e688","chunk-0c346784":"650191b5","chunk-3dc88c82":"650191b5","chunk-0a1d012c":"b315181b","chunk-2939ac1d":"7ee0a6c0","chunk-8956f106":"1643a8cc"}[e]+".css",s=c.p+a,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var u=o[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===a||l===s))return n()}var f=document.getElementsByTagName("style");for(i=0;i<f.length;i++){u=f[i],l=u.getAttribute("data-href");if(l===a||l===s)return n()}var g=document.createElement("link");g.rel="stylesheet",g.type="text/css",g.onload=n,g.onerror=function(n){var a=n&&n.target&&n.target.src||s,o=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=a,delete r[e],g.parentNode.removeChild(g),t(o)},g.href=s;var h=document.getElementsByTagName("head")[0];h.appendChild(g)})).then((function(){r[e]=0})));var a=s[e];if(0!==a)if(a)n.push(a[2]);else{var o=new Promise((function(n,t){a=s[e]=[n,t]}));n.push(a[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(e);var f=new Error;u=function(n){l.onerror=l.onload=null,clearTimeout(g);var t=s[e];if(0!==t){if(t){var a=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;f.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",f.name="ChunkLoadError",f.type=a,f.request=r,t[1](f)}s[e]=void 0}};var g=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(n)},c.m=e,c.c=a,c.d=function(e,n,t){c.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,n){if(1&n&&(e=c(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(c.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)c.d(t,a,function(n){return e[n]}.bind(null,a));return t},c.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(n,"a",n),n},c.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},c.p="/",c.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=n,u=u.slice();for(var f=0;f<u.length;f++)n(u[f]);var g=l;o.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"034f":function(e,n,t){"use strict";var a=t("1356"),r=t.n(a);r.a},1356:function(e,n,t){},"4c51":function(e,n,t){"use strict";n["a"]={ERROR_GENERIC_PROBLEM:"Parece que ha habido un problema con tu petición. Por favor, vuelve a intentarlo más tarde.",ERROR_GENERIC_CONNECTION_PROBLEM:"Parece que ha habido un problema de conexión. Por favor, vuelve a intentarlo más tarde.",ERROR_GENERIC_DATABASE_PROBLEM:"Parece que ha habido un problema con la base de datos. Por favor, vuelve a intentarlo más tarde.",ERROR_ALREADY_AN_ACCOUNT_WITH_THIS_EMAIL:"Ya existe una cuenta registrada con ese E-mail. Si es tuya, prueba a iniciar sesión-",ERROR_ALREADY_AN_ACCOUNT_WITH_THIS_USERNAME:"Ya existe un usuario con ese nombre.",ERROR_WRONG_EMAIL_PASSWORD_COMBINATION:"No existe una cuenta registrada con este E-mail o la contraseña es incorrecta.",ERROR_UPLOADING_IMAGE:"Error subiendo la imagen.",ERROR_SOMETHING_HAPPENED:"Parece que ha ocurrido un error.",ERROR_API_FILEREADER_NOT_SUPPORTED:"Lo sentimos, la API FileReader no está soportada.",ERROR_PASSWORDS_DONT_MATCH:"Las contraseñas no coinciden",ERROR_TOO_MANY_REQUESTS:"Parece que has realizado demasiadas peticiones en poco tiempo. Por favor, vuelve a intentarlo más tarde.",ERROR_TEXT_WRONG_PASSWORD:"Parece que la contraseña introducida no coincide con su contraseña actual.",ERROR_NO_ACCOUNT_WITH_THIS_EMAIL:"Parece que no hay ninguna cuenta registrada con este E-mail.",ERROR_GETTING_CURRENT_LOCATION:"Parece que ha habido un problema accediendo a su ubicación actual.",RULE_TEXT_MANDATORY_FIELD:"Este campo es obligatorio",RULE_MIN_VALUE_CHARACTERS_USERNAME:5,RULE_MAX_VALUE_CHARACTERS_USERNAME:14,RULE_TEXT_MIN_VALUE_CHARACTERS_USERNAME:"Mínimo 5 caracteres",RULE_TEXT_MAX_VALUE_CHARACTERS_USERNAME:"Máximo 14 caracteres",RULE_TEXT_MIN_VALUE_CHARACTERS_USERNAME_TO_START_SEARCHING:"Mínimo 5 caracteres para realizar la búsqueda",RULE_MIN_VALUE_CHARACTERS_USER_DESCRIPTION:20,RULE_TEXT_MIN_VALUE_CHARACTERS_USER_DESCRIPTION:"Mínimo 20 caracteres",RULE_TEXT_MIN_VALUE_CHARACTERS_PASSWORD:"Mínimo 8 caracteres",RULE_MIN_VALUE_AGE:16,RULE_YOU_HAVE_TO_BE_AT_LEAST_X_YEARS_OLD_TO_REGISTER:"Debes tener al menos 16 años.",ASK_FOR_IMAGE_SELECTION:"Por favor, selecciona una imagen",DATABASE_USERNAME_FIELD:"username",DATABASE_GENDER_FIELD:"gender",DATABASE_BIRTHDATE_FIELD:"birthDate",DATABASE_KNOWN_LANGUAGES_FIELD:"knownLanguages",DATABASE_LANGUAGES_TO_LEARN_FIELD:"languagesToLearn",DATABASE_AVG_RATING_FIELD:"avgRating",DATABASE_NUM_RATINGS_FIELD:"numRatings",DATABASE_DATE_FIELD:"date",RANKING_PAGE_SIZE:2,MAX_RANKING_PAGE_SIZE:100,SEARCHED_USERS_PAGE_SIZE:5,EVENTS_PAGE_SIZE:1,DATABASE_COLLECTION_EVENTS:"Events",MIN_USER_AGE:16,MAX_USER_AGE:100,TEXT_LANGUAGES_YOU_WANT_TO_IMPROVE:"¿Qué idiomas buscas mejorar?",TEXT_LANGUAGES_YOU_WANT_TO_PRACTICE:"Idiomas que quieres practicar",TEXT_LANGUAGES_YOU_SPEAK_FLUENTLY:"¿Qué idiomas hablas con soltura?",TEXT_MOTHER_LANGUAGES:"Idiomas maternos",TEXT_LANGUAGE_HE_SHE_WANT_TO_IMPROVE:"Idioma que busca mejorar",TEXT_LANGUAGE_HE_SHE_WANT_TO_PRACTICE:"Idioma que quiere practicar",TEXT_LANGUAGE_HE_SHE_SPEAK_FLUENTLY:"Idioma que habla con soltura",TEXT_MOTHER_LANGUAGE:"Idioma materno",TEXT_LANGUAGE:"Idioma",TEXT_GENDER:"Género",TEXT_DISTANCE:"Distancia",TEXT_AGE:"Edad",TEXT_FILTER_BY_MOTHER_LANGUAGE:"Filtrar por idioma materno",TEXT_FILTER_BY_LANGUAGE_TO_LEARN:"Filtrar por idioma que quiere practicar",TEXT_SEARCH:"Buscar",TEXT_NO_FIT_USERS_TO_LIST:"No se han encontrado usuarios que cumplan con los requisitos.",TEXT_FILTERS:"Filtros",TEXT_RATE_USER:"Valora al usuario",TEXT_YOU:"Tú",TEXT_CANCEL:"Cancelar",TEXT_RATE:"Valorar",TEXT_REMOVE:"Eliminar",TEXT_WATCH_MORE:"Ver más",TEXT_COULD_NOT_SET_YOUR_RATING:"Parece que ha habido un problema: No se ha podido guardar su valoración.",TEXT_PROBLEM_RETRIEVING_RANKING:"Parece que ha habido un problema al cargar el ranking. Por favor, comprueba tu conexión.",TEXT_PROBLEM_GETTING_CURRENT_LOCATION:"Parece que ha habido un problema: no se ha podido obtener tu localizacion actual.",TEXT_PROBLEM_GETTING_NEARBY_USERS:"Parece que ha habido un problema: no se han podido obtener los usuarios cercanos.",TEXT_PROBLEM_GETTING_EVENTS:"Parece que ha habido un problema: no se han podido obtener los eventos.",TEXT_NO_LIMIT:"Sin límite",TEXT_1_KM:"1 km",TEXT_5_KM:"5 km",TEXT_10_KM:"10 km",TEXT_20_KM:"20 km",TEXT_REMOVE_FILTERS:"Eliminar filtros",TEXT_YOUR_PROFILE:"Tu perfil",TEXT_EDIT:"Editar",TEXT_EDIT_PROFILE:"Editar perfil",TEXT_USERS:"Usuarios",TEXT_TO_FILTER:"Filtrar",TEXT_EVENTS:"Eventos",TEXT_RANKING:"Ranking",TEXT_CHATS:"Chats",TEXT_CHAT:"Chats",TEXT_CLOSE:"Cerrar",MONTHS_OF_THE_YEAR_IN_TEXT:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],TEXT_SHOW_USERS:"Mostrar usuarios",TEXT_OF:"de",TEXT_CREATE_YOUR_ACCOUNT:"Crea tu cuenta",TEXT_CREATE_AN_ACCOUNT:"Crear una cuenta",TEXT_NAME:"Nombre",TEXT_LASTNAME:"Apellidos",TEXT_EMAIL:"E-mail",TEXT_EMAIL_DIRECTION:"Correo electrónico",TEXT_PASSWORD:"Contraseña",TEXT_REPEAT_PASSWORD:"Repite la contraseña",TEXT_REGISTER:"Registrar",TEXT_REGISTER_NOW:"¡Regístrate ahora!",TEXT_ALREADY_HAVE_AN_ACCOUNT:"¿Ya tienes una cuenta?",TEXT_ACCESS_NOW:"¡Accede ahora!",TEXT_ACCESS_TO_YOUR_ACCOUNT:"Accede a tu cuenta",TEXT_VERIFICATION_EMAIL_SENT_TO:"Para poder continuar, completa el proceso de verificación a través del enlace que hemos enviado a tu E-mail:",TEXT_VERIFY_YOUR_EMAIL:"Verifica tu E-mail",TEXT_USERNAME:"Nombre de usuario",TEXT_FILL_YOUR_PROFILE:"Rellena tu perfil",TEXT_BIRTHDATE:"Fecha de nacimiento",TEXT_TELL_US_A_LITTLE_ABOUT_YOU:"Cuéntanos un poco sobre ti",TEXT_TO_CONTINUE:"Continuar",TEXT_YOUR_LANGUAGES:"Tus idiomas",TEXT_WOMAN:"Mujer",TEXT_MAN:"Hombre",TEXT_ANY:"Cualquiera",TEXT_OTHER:"Otro",TEXT_CHOOSE_YOUR_PROFILE_IMAGE:"Elige tu foto de perfil",TEXT_EMAIL_NOT_VALID:"E-mail no válido",TEXT_USERNAME_NOT_VALID:"Nombre de usuario no válido",TEXT_HAVE_YOU_FORGOTTEN_YOUR_PASSWORD:"¿Has olvidado tu contraseña?",TEXT_STILL_DONT_HAVE_AN_ACCOUNT:"¿Todavía no tienes una cuenta?",TEXT_TO_LOG_IN:"Iniciar sesión",TEXT_TO_LOG_OUT:"Cerrar sesión",TEXT_RESEND_EMAIL:"Volver a enviar E-mail",TEXT_YOU_ARE_ABOUT_TO_LOG_OUT:"Va a salir de su cuenta",TEXT_CONFIRM:"Confirmar",TEXT_ARE_YOU_SURE_YOU_WANT_TO_LOG_OUT:"¿Está seguro de que quiere cerrar sesión?",TEXT_PROFILE_INFO:"Información de perfil",TEXT_LANGUAGES_TO_PRACTICE:"Idiomas a practicar",TEXT_SAVE:"Guardar",TEXT_SETTINGS:"Configuración e información",TEXT_ACCOUNT:"Cuenta",TEXT_PERMISSIONS:"Permisos",TEXT_NAME_AND_LASTNAME:"Nombre y apellidos",TEXT_CHANGE_NAME_AND_LASTNAME:"Cambiar nombre y apellidos",TEXT_CHANGE_EMAIL:"Cambiar correo electrónico",TEXT_UPDATE:"Actualizar",TEXT_VERIFY_YOUR_PASSWORD:"Verifica tu contraseña",TEXT_REMOVE_ACCOUNT:"Borrar cuenta",TEXT_INTRODUCE_YOUR_PASSWORD_TO_CONTINUE:"Vuelve a introducir tu contraseña de WeBabble para continuar.",TEXT_YOUR_EMAIL_HAS_BEEN_UPDATED:"Tu dirección de correo electrónico ha sido actualizada.",TEXT_YOUR_PASSWORD_HAS_BEEN_UPDATED:"Tu contraseña ha sido actualizada.",TEXT_CHANGE_PASSWORD:"Cambiar contraseña",TEXT_CURRENT_PASSWORD:"Contraseña actual",TEXT_NEW_PASSWORD:"Nueva contraseña",TEXT_CONFIRM_PASSWORD:"Confirmar la contraseña",TEXT_UPDATE_PASSWORD:"Actualizar contraseña",TEXT_ENTER_YOUR_EMAIL_TO_RESET_YOUR_PASSWORD:"Introduce tu E-mail y te ayudaremos a recuperar la contraseña:",TEXT_RESET_PASSWORD:"Restablecer contraseña",TEXT_RESET_PASSWORD_INSTRUCTIONS:"En un breve período de tiempo recibirás un email. Ábrelo y sigue las instrucciones para restablecer tu contraseña.",TEXT_SPACE_YEARS:" años",TEXT_PARTICIPANTS:"Participantes",TEXT_NO_PARTICIPANTS_YET:"Parece que todavía no se ha apuntado nadie. ¡Sé el primero!",TEXT_VERIFICATION_EMAIL_SENT:"E-mail de verificación enviado.",TEXT_NO_USERS_MATCH_SEARCH:"Parece que no hay usuarios que coincidan con tu búsqueda.",TEXT_NO_EVENTS_AVAILABLE:"Parece que no hay eventos disponibles.",TEXT_NO_CHATS_AVAILABLE:"Parece que no tienes ningún chat todavía. ¡Comienza a hablar con algún usuario!.",TEXT_LANGUAGE_INVOLVED_IN_EVENTS:"Idioma de los eventos",TEXT_LOCATION_PERMISSION_NOT_GRANTED:"Parece que no has dado permiso para acceder a tu localización. Concédelo para poder disponer de esta funcionalidad.",IMG_USER_PROFILE_HEADER:"img/backgrounds/user_profile_header.png",IMG_EMOJI_SAD_FACE:"img/emojis/sad_face.png"}},"559b":function(e,n,t){"use strict";t("55dd");n["a"]={arraysContainSameElements:function(e,n){if(!Array.isArray(e)||!Array.isArray(n)||e.length!==n.length)return!1;for(var t=e.concat().sort(),a=n.concat().sort(),r=0;r<t.length;r++)if(t[r]!==a[r])return!1;return!0},shuffle:function(e){e.sort((function(){return Math.random()-.5}))},emptyCallback:function(){},angleInRad:function(){return function(e){return e*Math.PI/180}},generateChatID:function(e,n){var t;return t=e<n?e+n:n+e,t}}},"56d7":function(e,n,t){"use strict";t.r(n);t("cadf"),t("551c"),t("f751"),t("097d");var a=t("2b0e"),r=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-app",{staticStyle:{"max-width":"100%",height:"100%"}},[e.dataIsReady?t("router-view",{staticStyle:{"max-width":"100%",height:"100%"}}):e._e()],1)},s=[],o=(t("8e6e"),t("ac6a"),t("456d"),t("a481"),t("bd86")),i=t("2f62"),c=t("8aa5"),u=t.n(c),l=t("4c51");function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function g(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(t,!0).forEach((function(n){Object(o["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var h={name:"App",components:{},data:function(){return{dataIsReady:!1}},methods:g({},Object(i["b"])("user",["getRegistrationState"]),{},Object(i["b"])(["initAppInfo","getLoggedUser"])),created:function(){var e=this;e.getLoggedUser().then((function(n){if(null!=n&&void 0!=n){var t=e.initAppInfo();t.then((function(){e.dataIsReady=!0})).catch((function(n){e.snackbarText=n,e.snackbar=!0}))}else e.$store.dispatch("resetAppState").then((function(){e.$router.replace("home")})).catch((function(n){e.snackbarText=n,e.snackbar=!0})),e.dataIsReady=!0,console.log("No user logged")}))}},d=h,m=(t("034f"),t("2877")),E=t("6544"),I=t.n(E),R=t("7496"),_=Object(m["a"])(d,r,s,!1,null,null,null),p=_.exports;I()(_,{VApp:R["a"]});t("f559"),t("7f7f");var T=t("8c4f"),A=function(){var e=this,n=e.$createElement,a=e._self._c||n;return a("div",{staticClass:"img-back"},[a("v-container",{staticClass:"home",staticStyle:{height:"100%",position:"relative",width:"100%"},attrs:{align:"center"}},[a("div",{staticStyle:{width:"100%"},attrs:{align:"center"}},[a("img",{attrs:{src:t("cf05")}})]),a("div",{staticClass:"bottom-centered-buttons",attrs:{align:"center"}},[a("div",{staticStyle:{width:"100%"},attrs:{align:"center"}},[a("router-link",{attrs:{to:"/sign-up"}},[a("v-btn",{staticStyle:{width:"100%"},attrs:{color:"primary"}},[e._v(e._s(e.createAnAccountText))])],1)],1),a("br"),a("div",{staticStyle:{width:"100%"},attrs:{align:"center"}},[a("router-link",{attrs:{to:"/login"}},[a("v-btn",{staticStyle:{width:"100%"},attrs:{color:"primary"}},[e._v(e._s(e.toLogInText))])],1)],1)])])],1)},b=[],O={name:"home",data:function(){return{createAnAccountText:l["a"].TEXT_CREATE_AN_ACCOUNT,toLogInText:l["a"].TEXT_TO_LOG_IN}}},v=O,P=(t("d903"),t("8336")),U=t("a523"),D=Object(m["a"])(v,A,b,!1,null,"58559630",null),S=D.exports;I()(D,{VBtn:P["a"],VContainer:U["a"]});t("5df3"),t("7514"),t("20d6");var L=t("5cdc"),w=(t("96cf"),t("3b8d"));t("bc3a");function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(t,!0).forEach((function(n){Object(o["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}a["a"].use(i["a"]);var y={namespaced:!0,state:{},getters:{},mutations:{},actions:{isUserAuth:function(){return c["auth"]().currentUser},setAccount:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Accounts").doc(c["auth"]().currentUser.uid).set({name:n.name,lastName:n.lastName,role:"user",chats:[],tokens:[]},{merge:!0}).then((function(){console.log("Account info successfully written in firebase"),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},askForMessagingPermission:function(e){return new Promise((function(e,n){c["messaging"]().requestPermission().then((function(){e(!0)})).catch((function(){e(!1)}))}))},generatePushNotificationToken:function(e){return new Promise((function(e,n){c["messaging"]().getToken().then(function(){var t=Object(w["a"])(regeneratorRuntime.mark((function t(a){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}return t.next=3,window.localStorage.getItem("messagingToken");case 3:r=t.sent,console.log("token will be updated",r!=a),r!=a&&(console.log("token"),s=c["firestore"](),s.collection("Accounts").doc(c["auth"]().currentUser.uid).update({tokens:c["firestore"].FieldValue.arrayUnion(a)}).then((function(){e()})).catch((function(e){console.error(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))),t.next=9;break;case 8:n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.error(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getAccount:function(){return new Promise((function(e,n){var t=c["firestore"]();t.collection("Accounts").doc(c["auth"]().currentUser.uid).get().then((function(n){console.log("Account info successfully retrieved from firebase"),e(C({id:n.id,email:c["auth"]().currentUser.email},n.data()))})).catch((function(e){console.error(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},createAccountListener:function(e,n){return new Promise((function(t,a){var r=c["firestore"]();try{var s=r.collection("Accounts").doc(n).onSnapshot((function(a){var r=C({id:n},a.data(),{listener:s});e.dispatch("chats/manageChatListChange",r,{root:!0}).then((function(){t(r)}))}))}catch(o){console.error(o),a(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}}))},createAccount:function(e,n){return new Promise((function(e,t){c["auth"]().createUserWithEmailAndPassword(n.email,n.password).then((function(){console.log("Success creating account in firebase."),e()})).catch((function(e){console.error(e),"auth/email-already-in-use"==e.code?t(l["a"].ERROR_ALREADY_AN_ACCOUNT_WITH_THIS_EMAIL):t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},setPersistance:function(){return new Promise((function(e,n){c["auth"]().setPersistence(c["auth"].Auth.Persistence.LOCAL).then((function(){console.log("Success setting firebase account persistence."),e()})).catch((function(e){console.error(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},login:function(e,n){return new Promise((function(e,t){c["auth"]().signInWithEmailAndPassword(n.email,n.password).then((function(){console.log("Success logging user in firebase."),e()})).catch((function(e){console.error(e),"auth/wrong-password"==e.code||"auth/user-not-found"==e.code?t(l["a"].ERROR_WRONG_EMAIL_PASSWORD_COMBINATION):"auth/too-many-requests"==e.code?t(l["a"].ERROR_TOO_MANY_REQUESTS):t(l["a"].ERROR_GENERIC_PROBLEM)}))}))},logout:function(){return new Promise((function(e,n){null!=c["auth"]()&&c["auth"]().signOut().then((function(){console.log("User logged out correctly of firebase!"),e()})).catch((function(e){console.error(e),n(l["a"].ERROR_GENERIC_PROBLEM)}))}))},sendEmailVerification:function(){return new Promise((function(e,n){c["auth"]().currentUser.sendEmailVerification().then((function(){console.log("Firebase verification email sent."),e()}),(function(e){console.error(e),"auth/too-many-requests"==e.code?n(l["a"].ERROR_TOO_MANY_REQUESTS):n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},isEmailVerified:function(){return new Promise((function(e,n){c["auth"]().currentUser.reload().then((function(){c["auth"]().currentUser.emailVerified?(console.log("Firebase account email is verified."),e(!0)):e(!1)})).catch((function(e){console.error(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},sendPasswordResetEmail:function(e,n){return new Promise((function(e,t){c["auth"]().sendPasswordResetEmail(n).then((function(){console.log("Password reset email sent."),e()})).catch((function(n){"auth/user-not-found"==n.code?(console.log("No account attached to the specified email."),e()):(console.error(n),t(l["a"].ERROR_GENERIC_PROBLEM))}))}))},updateAccountData:function(e,n){return new Promise((function(e,t){var a=c["firestore"](),r=a.batch(),s=a.collection("Accounts").doc(c["auth"]().currentUser.uid),o=!1;n.hasOwnProperty("name")&&(r.update(s,{name:n.name}),o=!0),n.hasOwnProperty("lastName")&&(r.update(s,{lastName:n.lastName}),o=!0),o?r.commit().then((function(){console.log("Account info successfully updated in firebase"),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)})):e()}))},updateAccountEmail:function(e,n){return new Promise((function(e,t){var a=c["auth"]().currentUser;a.updateEmail(n).then((function(){console.log("Account email successfully updated in firebase"),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_PROBLEM)}))}))},updateAccountPassword:function(e,n){return new Promise((function(e,t){var a=c["auth"]().currentUser;a.updatePassword(n).then((function(){console.log("Account password successfully updated in firebase"),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_PROBLEM)}))}))},getProfileByUID:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Profiles").doc(n).get().then((function(n){null!=n.data()&&void 0!=n.data()?(n.data().hasOwnProperty("birthDate")&&(n.data()["birthDate"]=n.data()["birthDate"].toDate().setHours(0,0,0)),e(C({id:n.id},n.data()))):e(null)})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getProfile:function(e){return new Promise((function(n,t){e.dispatch("getProfileByUID",c["auth"]().currentUser.uid).then((function(e){e&&e.hasOwnProperty("birthDate")&&(e["birthDate"]=e["birthDate"].toDate().setHours(0,0,0)),console.log("Profile info successfully retrieved from firebase"),n(e)})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getMultipleProfilesByUID:function(e,n){return new Promise((function(t,a){var r=[],s=[];n.forEach((function(n){r.push(e.dispatch("getProfileByUID",n).then((function(e){s.push(C({id:n},e))})).catch((function(e){console.error(e),a(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)})))})),Promise.all(r).then((function(){t(s)}))}))},getProfileByUsername:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Profiles").where("username","==",n).get().then((function(n){n.size>0?(console.log("Profile info successfully retrieved from firebase"),e(n.docs)):(console.log("Profile info was not found in firebase"),e(null))})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},setProfile:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Profiles").doc(c["auth"]().currentUser.uid).set({username:n.username.toLowerCase(),birthDate:new Date(new Date(n.birthDate).setHours(0,0,0)),gender:n.gender,description:n.description,avgRating:0,numRatings:0,score:0},{merge:!0}).then((function(){console.log("Profile info successfully written in firebase"),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},setRegistrationCompleted:function(e,n){return new Promise((function(e,n){var t=c["firestore"]();t.collection("Profiles").doc(c["auth"]().currentUser.uid).set({registrationCompleted:!0},{merge:!0}).then((function(){console.log("Registration state successfully written in firebase"),e()})).catch((function(e){console.error(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},updateProfile:function(e,n){return new Promise((function(e,t){var a=c["firestore"](),r=a.batch(),s=a.collection("Profiles").doc(c["auth"]().currentUser.uid),o=!1;n.hasOwnProperty("username")&&(r.update(s,{username:n.username}),o=!0),n.hasOwnProperty("description")&&(r.update(s,{description:n.description}),o=!0),n.hasOwnProperty("gender")&&(r.update(s,{gender:n.gender}),o=!0),n.hasOwnProperty("birthDate")&&(r.update(s,{birthDate:new Date(new Date(n.birthDate).setHours(0,0,0))}),o=!0),n.hasOwnProperty("knownLanguages")&&(r.update(s,{knownLanguages:n.knownLanguages}),o=!0),n.hasOwnProperty("languagesToLearn")&&(r.update(s,{languagesToLearn:n.languagesToLearn}),o=!0),o?r.commit().then((function(){console.log("Profile info successfully updated in firebase"),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)})):e()}))},setLanguages:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Profiles").doc(c["auth"]().currentUser.uid).set({knownLanguages:n.knownLanguages,languagesToLearn:n.languagesToLearn},{merge:!0}).then((function(){console.log("User languages info successfully written in firebase."),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},uploadProfileImg:function(e,n){return new Promise((function(t,a){var r=c["auth"]().currentUser.uid,s="UserProfileImages/"+r,o={img:n,path:s};e.dispatch("uploadImg",o).then((function(e){t(e)})).catch((function(e){console.error(e),a(l["a"].ERROR_UPLOADING_IMAGE)}))}))},uploadImg:function(e,n){return new Promise((function(e,t){var a=c["storage"]().ref().child(n.path);a.putString(n.img,"base64").then((function(){a.getDownloadURL().then((function(n){console.log("User profile image uploaded."),e(n)})).catch((function(e){console.error(e),t(l["a"].ERROR_UPLOADING_IMAGE)}))})).catch((function(e){console.error(e),t(l["a"].ERROR_UPLOADING_IMAGE)}))}))},setProfileImg:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Profiles").doc(c["auth"]().currentUser.uid).set({profileImg:n},{merge:!0}).then((function(){console.log("User profile image successfully written in firebase."),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_UPLOADING_IMAGE)}))}))},updateUserLocation:function(e,n){var t=new L["GeoFirestore"](c["firestore"]());return new Promise((function(e,a){t.collection("UserLocations").doc(c["auth"]().currentUser.uid).set({coordinates:new c["firestore"].GeoPoint(n.lat,n.lng),date:new Date}).then((function(){console.log("User location successfully written in firebase."),e()})).catch((function(e){console.log(e),a(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getLocation:function(){return new Promise((function(e,n){var t=c["firestore"]();t.collection("UserLocations").doc(c["auth"]().currentUser.uid).get().then((function(n){console.log("User location successfully retrieved from firebase.");var t={lat:n.data().l[0],lng:n.data().l[1]};e(t)})).catch((function(e){console.error(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getRatings:function(){var e=c["firestore"]();return new Promise((function(n,t){e.collection("Ratings").doc(c["auth"]().currentUser.uid).get().then((function(e){console.log("User ratings successfully retrieved from firebase."),e.exists?n(e.data()):n(null)})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},setRating:function(e,n){return new Promise((function(e,t){var a=c["firestore"](),r={};r[n.id]=n.rating,n.rating?a.collection("Ratings").doc(c["auth"]().currentUser.uid).set(r,{merge:!0}).then((function(){console.log("Rating successfully written in firebase."),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)})):a.collection("Ratings").doc(c["auth"]().currentUser.uid).update(Object(o["a"])({},n.id,c["firestore"].FieldValue.delete())).then((function(){console.log("Rating successfully deleted in firebase."),e()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},isNextUsersPageEmpty:function(e,n){return new Promise((function(e,t){var a,r=c["firestore"](),s=(new L["GeoFirestore"](r),n.lastUserShowed);if(a=r.collection("Profiles"),null!=n.filters.username&&void 0!=n.filters.username&&""!=n.filters.username&&null==s&&(s=n.filters.username),"M"===n.filters.gender?a=a.where("gender","==","M"):"W"===n.filters.gender&&(a=a.where("gender","==","W")),(n.filters.ageRange[0]>l["a"].MIN_USER_AGE||n.filters.ageRange[1]<l["a"].MAX_USER_AGE)&&(a=a.orderBy("birthDate")),n.filters.ageRange[0]>l["a"].MIN_USER_AGE){var o=new Date;o.setFullYear(o.getFullYear()-n.filters.ageRange[0]),o.setHours(0,0,0),a=a.where("birthDate","<",o)}if(n.filters.ageRange[1]<l["a"].MAX_USER_AGE){var i=new Date;i.setFullYear(i.getFullYear()-n.filters.ageRange[1]-1),i.setHours(0,0,0),a=a.where("birthDate",">",i)}"languageToLearn"==n.filters.language.filterBy&&"all"!=n.filters.language.languageToLearn?a=a.where("languagesToLearn","array-contains",n.filters.language.languageToLearn):"knownLanguage"==n.filters.language.filterBy&&"all"!=n.filters.language.knownLanguage&&(a=a.where("knownLanguages","array-contains",n.filters.language.knownLanguage)),a=a.where("registrationCompleted","==",!0),a=null!=n.filters.username&&void 0!=n.filters.username&&""!=n.filters.username?a.orderBy("username").startAfter(s).endAt(n.filters.username+"").limit(n.limit):a.orderBy("username").startAfter(s).limit(n.limit),a.get().then((function(n){var t=n.docs.findIndex((function(e){return e.id==c["auth"]().currentUser.uid})),a=n.docs;-1!=t&&a.splice(t,1),a=a.map((function(e){var n=e.id,t=e.data();return C({id:n},t)})),e(0==a.length)})).catch((function(e){console.log(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getNextUsersPage:function(e,n){return new Promise((function(e,t){var a,r,s=c["firestore"](),o=(new L["GeoFirestore"](s),n.lastUserShowed);if(a=s.collection("Profiles"),null!=n.filters.username&&void 0!=n.filters.username&&""!=n.filters.username&&null==o&&(o=n.filters.username),"M"===n.filters.gender?a=a.where("gender","==","M"):"W"===n.filters.gender&&(a=a.where("gender","==","W")),a=a.where("registrationCompleted","==",!0),(n.filters.ageRange[0]>l["a"].MIN_USER_AGE||n.filters.ageRange[1]<l["a"].MAX_USER_AGE)&&(a=a.orderBy("birthDate")),n.filters.ageRange[0]>l["a"].MIN_USER_AGE){var i=new Date;i.setFullYear(i.getFullYear()-n.filters.ageRange[0]),i.setHours(0,0,0),a=a.where("birthDate","<",i)}if(n.filters.ageRange[1]<l["a"].MAX_USER_AGE){var u=new Date;u.setFullYear(u.getFullYear()-n.filters.ageRange[1]-1),u.setHours(0,0,0),a=a.where("birthDate",">",u)}"languageToLearn"==n.filters.language.filterBy&&"all"!=n.filters.language.languageToLearn?a=a.where("languagesToLearn","array-contains",n.filters.language.languageToLearn):"knownLanguage"==n.filters.language.filterBy&&"all"!=n.filters.language.knownLanguage&&(a=a.where("knownLanguages","array-contains",n.filters.language.knownLanguage)),a=null==n.lastUserShowed&&null!=n.filters.username&&void 0!=n.filters.username&&""!=n.filters.username?a.orderBy("username").startAt(o).endAt(n.filters.username+"").limit(n.limit):null!=n.lastUserShowed&&null!=n.filters.username&&void 0!=n.filters.username&&""!=n.filters.username?a.orderBy("username").startAfter(o).endAt(n.filters.username+"").limit(n.limit):a.orderBy("username").startAfter(o).limit(n.limit),a.get().then((function(n){var t=n.docs.findIndex((function(e){return e.id==c["auth"]().currentUser.uid})),a=n.docs;-1!=t&&a.splice(t,1),r=n.docs[n.docs.length-1],a=a.map((function(e){var n=e.id,t=e.data();return C({id:n},t)})),e({newLastUserShowed:r,users:a})})).catch((function(e){console.log(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getNearbyUserIDs:function(e,n){return new Promise((function(e,t){var a=new L["GeoFirestore"](c["firestore"]()),r=a.collection("UserLocations").near({center:new c["firestore"].GeoPoint(n.location.lat,n.location.lng),radius:n.maxDistance});console.log(n.maxDistance),r.get().then((function(n){var t=[];n.docs.forEach((function(e){e.id!=c["auth"]().currentUser.uid&&t.push(e.id)})),e(t)})).catch((function(e){console.log(e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},getUsersWithSimilarUsername:function(e,n){return new Promise((function(e,n){var t=new L["GeoFirestore"](c["firestore"]()),a=t.collection("UserLocations").near({center:new c["firestore"].GeoPoint(data.location.lat,data.location.lng),radius:data.maxDistance});a.get().then((function(n){var t=[];n.docs.forEach((function(e){e.id!=c["auth"]().currentUser.uid&&t.push(e.id)})),e(t)})).catch((function(e){console.log(e),n(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},getEventByID:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Events").doc(n).get().then((function(n){null!=n.data()&&void 0!=n.data()?e(C({id:n.id},n.data())):e(null)})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getNextEventsPage:function(e,n){return new Promise((function(e,t){var a,r,s=c["firestore"](),o=n.lastEventShowed,i=new Date;a=s.collection("Events"),"all"!==n.filters.languageInvolved&&(a=a.where("involvedLanguages","array-contains",n.filters.languageInvolved)),a=null==o?a.where("date",">",i).orderBy("date").startAt(o):a.where("date",">",i).orderBy("date").startAfter(o),a.limit(n.limit).get().then((function(n){r=n.docs[n.docs.length-1];var t=n.docs.map((function(e){var n=e.id,t=e.data();return C({id:n},t)}));e({newLastEventShowed:r,events:t})})).catch((function(e){console.log(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getEventsToBeCelebrated:function(e){return new Promise((function(e,n){var t,a=c["firestore"](),r=new Date;t=a.collection("Events"),t=t.where("date",">",r).orderBy("date"),t.get().then((function(n){var t=n.docs.map((function(e){var n=e.id,t=e.data();return C({id:n},t)}));e(t)})).catch((function(e){console.log(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},isNextEventsPageEmpty:function(e,n){return new Promise((function(e,t){var a,r=c["firestore"](),s=n.lastEventShowed,o=new Date;a=r.collection("Events"),"all"!==n.filters.languageInvolved&&(a=a.where("involvedLanguages","array-contains",n.filters.languageInvolved)),a=a.where("date",">",o).orderBy("date").startAfter(s),a.limit(n.limit).get().then((function(n){e(0==n.docs.length)})).catch((function(e){console.log(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},addParticipantToEvent:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Events").doc(n).update({participants:c["firestore"].FieldValue.arrayUnion(c["auth"]().currentUser.uid)}).then((function(n){console.log("User successfully added to event in firebase."),e(c["auth"]().currentUser.uid)})).catch((function(e){console.log(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},removeParticipantFromEvent:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Events").doc(n).update({participants:c["firestore"].FieldValue.arrayRemove(c["auth"]().currentUser.uid)}).then((function(n){console.log("User successfully remove from event in firebase."),e(c["auth"]().currentUser.uid)})).catch((function(e){console.log(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},createChatMessagesListener:function(e,n){return new Promise((function(t,a){var r=c["firestore"]();try{var s=r.collection("Chats").doc(n).collection("Messages").onSnapshot((function(a){var r=a.docChanges().map((function(e){var n=e.doc.id,t=e.doc.data();return C({id:n,change:e.type},t)})),o={id:n,messages:r,listener:s};e.dispatch("chats/manageChatMessagesChange",o,{root:!0}).then((function(){t()}))}))}catch(o){console.error(o),a(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}}))},setMessagesToRead:function(e,n){return new Promise((function(e,t){var a=c["firestore"](),r=a.batch();n.messages.forEach((function(e){r.update(a.collection("Chats").doc(n.chatID).collection("Messages").doc(e),{read:!0})})),r.commit().then((function(){e()})).catch((function(e){t(e)}))}))},addMessagesToChat:function(e,n){return new Promise((function(e,t){var a=c["firestore"](),r={date:c["firestore"].FieldValue.serverTimestamp(),sender:n.message.sender,read:!1,text:n.message.text};a.collection("Chats").doc(n.chatID).collection("Messages").doc().set(r).then((function(){e()})).catch((function(e){console.error("Error adding message",e),t(l["a"].ERROR_GENERIC_PROBLEM)}))}))},addChat:function(e,n){return new Promise((function(e,t){var a=c["firestore"](),r={users:n.users};a.collection("Chats").doc(n.id).set(r).then((function(){a.collection("Accounts").doc(c["auth"]().currentUser.uid).update({chats:c["firestore"].FieldValue.arrayUnion(n.id)}).then((function(){e()}))})).catch((function(e){console.error("Error adding chat",e),t(l["a"].ERROR_GENERIC_PROBLEM)}))}))},getChatByID:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Chats").doc(n).get().then((function(n){e(C({id:n.id},n.data()))})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getTop100RankingUsers:function(){return new Promise((function(e,n){var t=c["firestore"](),a=t.collection("Ranking");a=a.orderBy("position").limit(l["a"].MAX_RANKING_PAGE_SIZE),a.get().then((function(n){var t=n.docs.map((function(e){var n=e.id,t=e.data();return C({position:n},t)}));e(t)})).catch((function(e){console.log(e),n(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))},getUserRankingPositionByID:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("Ranking").where("id","==",n).get().then((function(n){var t=n.docs.map((function(e){var n=e.id,t=e.data();return C({position:n},t)}));t.length>1||t.length<1?e(null):e(t[0])})).catch((function(e){console.log(e),t(l["a"].ERROR_GENERIC_DATABASE_PROBLEM)}))}))}}},k=t("559b");a["a"].use(i["a"]);var B={namespaced:!0,modules:{database:y},state:{isGeolocationPermissionGranted:!1,isPushNotificationPermissionGranted:!1},getters:{getIsGeolocationPermissionGranted:function(e){return e.isGeolocationPermissionGranted},getIsPushNotificationPermissionGranted:function(e){return e.isPushNotificationPermissionGranted}},mutations:{resetState:function(e){e.isGeolocationPermissionGranted=!1,e.isPushNotificationPermissionGranted=!1},setIsGeolocationPermissionGranted:function(e,n){e.isGeolocationPermissionGranted=n},setIsPushNotificationPermissionGranted:function(e,n){e.isPushNotificationPermissionGranted=n}},actions:{resetState:function(e){return new Promise((function(n,t){e.commit("resetState"),n()}))},checkForGeolocationPermission:function(e){return new Promise((function(n,t){navigator.permissions.query({name:"geolocation"}).then((function(a){"granted"==a.state?(e.commit("setIsGeolocationPermissionGranted",!0),e.dispatch("user/getLocation",null,{root:!0}).catch((function(e){t(e)})),n(!0)):"prompt"==a.state?(e.commit("setIsGeolocationPermissionGranted",!1),navigator.geolocation.getCurrentPosition(k["a"].emptyCallback)):"denied"==a.state&&(e.commit("setIsGeolocationPermissionGranted",!1),n(!1)),a.onchange=function(){"granted"==a.state?(e.commit("setIsGeolocationPermissionGranted",!0),e.dispatch("user/getLocation",null,{root:!0}).catch((function(e){t(e)})),n(!0)):"prompt"==a.state?(e.commit("setIsGeolocationPermissionGranted",!1),navigator.geolocation.getCurrentPosition(k["a"].emptyCallback)):"denied"==a.state&&(e.commit("setIsGeolocationPermissionGranted",!1),n(!1))}}))}))},checkForPushNotificationsPermission:function(e){return new Promise((function(n,t){e.dispatch("database/askForMessagingPermission").then((function(a){a?(e.commit("setIsPushNotificationPermissionGranted",!0),e.dispatch("user/generateNotificationToken",null,{root:!0}).catch((function(e){t(e)})),n(!0)):(e.commit("setIsPushNotificationPermissionGranted",!1),n(!1))}))}))}}};function M(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function G(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?M(t,!0).forEach((function(n){Object(o["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}a["a"].use(i["a"]);var F={namespaced:!0,modules:{database:y,permissions:B},state:{users:{},searchedUsersIDs:[],lastUserShowed:null,genderFilter:"O",ageRangeFilter:[l["a"].MIN_USER_AGE,l["a"].MAX_USER_AGE],languageFilter:{filterBy:"languageToLearn",knownLanguage:"all",languageToLearn:"all"},searchByUsernameFilter:null,maxDistanceFilter:3,maxDistanceRanges:[1,5,10,null],maxDistanceRangesText:[l["a"].TEXT_1_KM,l["a"].TEXT_5_KM,l["a"].TEXT_10_KM,"∞"],locationFilter:null,nearbyUsersIDs:null,distanceSearchFilter:null},getters:{getUsers:function(e){return e.users},getLanguagesByUserID:function(e){return function(n){return e.users[n].knownLanguages.concat(e.users[n].languagesToLearn)}},getGenderFilter:function(e){return e.genderFilter},getAgeRangeFilter:function(e){return e.ageRangeFilter},getLanguageFilter:function(e){return e.languageFilter},getSearchByUsernameFilter:function(e){return e.searchByUsernameFilter},getMaxDistanceFilter:function(e){return e.maxDistanceFilter},getMaxDistanceRanges:function(e){return e.maxDistanceRanges},getMaxDistanceRangesText:function(e){return e.maxDistanceRangesText},getUserByID:function(e){return function(n){return e.users[n]}},getNearbyUsersIDs:function(e){return e.nearbyUsersIDs},getNearbyUsersIDsLength:function(e){return e.nearbyUsersIDs.length},areThereFiltersOn:function(e,n){var t=n.getFilters,a=!1;return("M"===t.gender||"W"===t.gender||t.ageRange[0]>l["a"].MIN_USER_AGE||t.ageRange[1]<l["a"].MAX_USER_AGE||"languageToLearn"==t.language.filterBy&&"all"!=t.language.languageToLearn||"knownLanguage"==t.language.filterBy&&"all"!=t.language.knownLanguage||null!=t.maxDistance)&&(a=!0),a},getFilters:function(e){return{gender:e.genderFilter,ageRange:e.ageRangeFilter,language:e.languageFilter,maxDistance:e.maxDistanceRanges[e.maxDistanceFilter],location:e.locationFilter,username:e.searchByUsernameFilter}},getLastUserShowed:function(e){return e.lastUserShowed},getSearchedUsers:function(e){var n=[];return e.searchedUsersIDs.forEach((function(t){n.push(G({id:t},e.users[t]))})),n},getSearchedUsersIDsLength:function(e){return e.searchedUsersIDs.length},getSearchedUsersIDs:function(e){return e.searchedUsersIDs}},mutations:{resetState:function(e){e.users={},e.searchedUsersIDs=[],e.lastUserShowed=null,e.genderFilter="O",e.ageRangeFilter=[l["a"].MIN_USER_AGE,l["a"].MAX_USER_AGE],e.languageFilter={filterBy:"languageToLearn",knownLanguage:"all",languageToLearn:"all"},e.searchByUsernameFilter=null,e.maxDistanceFilter=3,e.maxDistanceRanges=[1e3,5e3,1e4,null],e.maxDistanceRangesText=[l["a"].TEXT_1_KM,l["a"].TEXT_5_KM,l["a"].TEXT_10_KM,"∞"],e.locationFilter=null,e.nearbyUsersIDs=null,e.distanceSearchFilter=null},setUsers:function(e,n){e.users=n},setGenderFilter:function(e,n){e.genderFilter=n},setAgeRangeFilter:function(e,n){e.ageRangeFilter=n},setNearbyUsersIDs:function(e,n){e.nearbyUsersIDs=n},setLanguageFilter:function(e,n){e.languageFilter=n},setLocationFilter:function(e,n){e.locationFilter=n},setSearchByUsernameFilter:function(e,n){e.searchByUsernameFilter=n},setMaxDistanceFilter:function(e,n){e.maxDistanceFilter=n},addUser:function(e,n){e.users[n.id]=n},addSearchedUserID:function(e,n){e.searchedUsersIDs.push(n)},resetSearchedUsersIDs:function(e){e.searchedUsersIDs=[]},setLastUserShowed:function(e,n){e.lastUserShowed=n},addRating:function(e,n){var t=e.users[n.id];if(null==n.prev){var a=t.avgRating*t.numRatings;a+=n.rating,a/=t.numRatings+1,e.users[n.id].avgRating=a,e.users[n.id].numRatings=t.numRatings+1}else if(null==n.rating){var r=t.avgRating*t.numRatings;r-=n.prev,t.numRatings-1!=0&&(r/=t.numRatings-1),e.users[n.id].avgRating=r,e.users[n.id].numRatings=t.numRatings-1}else{var s=t.avgRating*t.numRatings;s=s+n.rating-n.prev,0!=t.numRatings&&(s/=t.numRatings),e.users[n.id].avgRating=s}}},actions:{resetState:function(e){e.commit("resetState")},getSearchedUsers:function(e){return new Promise((function(n,t){var a=e.getters.getFilters;null!=a.location&&void 0!=a.location&&null!=a.maxDistance?null==e.getters.getLastUserShowed?e.dispatch("database/getNearbyUserIDs",{location:a.location,maxDistance:a.maxDistance}).then((function(a){e.commit("setNearbyUsersIDs",a),e.dispatch("getNearbyUsersProfiles").then((function(){e.dispatch("areThereMoreNearbyUsers").then((function(e){n(e)})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))})).catch((function(e){t(e)})):e.dispatch("getNearbyUsersProfiles").then((function(){e.dispatch("areThereMoreNearbyUsers").then((function(e){n(e)})).catch((function(e){t(e)}))})).catch((function(e){t(e)})):e.dispatch("database/getNextUsersPage",{lastUserShowed:e.getters.getLastUserShowed,limit:l["a"].SEARCHED_USERS_PAGE_SIZE,filters:a}).then((function(r){e.commit("setLastUserShowed",r.newLastUserShowed),r.users.forEach((function(n){e.commit("addUser",n),e.commit("addSearchedUserID",n.id)})),r.users.length>0&&e.dispatch("database/isNextUsersPageEmpty",{lastUserShowed:e.getters.getLastUserShowed,limit:l["a"].SEARCHED_USERS_PAGE_SIZE,filters:a}).then((function(s){r.users.length>0&&r.users.length<l["a"].SEARCHED_USERS_PAGE_SIZE&&!s?e.dispatch("database/getNextUsersPage",{lastUserShowed:e.getters.getLastUserShowed,limit:l["a"].SEARCHED_USERS_PAGE_SIZE-r.users.length,filters:a}).then((function(r){e.commit("setLastUserShowed",r.newLastUserShowed),r.users.forEach((function(n){e.commit("addUser",n),e.commit("addSearchedUserID",n.id)})),e.dispatch("database/isNextUsersPageEmpty",{lastUserShowed:e.getters.getLastUserShowed,limit:l["a"].SEARCHED_USERS_PAGE_SIZE,filters:a}).then((function(e){n(!e)})).catch((function(e){t(e)}))})).catch((function(e){t(e)})):n(!s)})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))}))},areThereMoreNearbyUsers:function(e){return new Promise(function(){var n=Object(w["a"])(regeneratorRuntime.mark((function n(t,a){var r,s,o,i,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=e.getters.getNearbyUsersIDs,s=e.getters.getFilters,o=e.getters.getLastUserShowed;case 3:if(!(o+1<e.getters.getNearbyUsersIDsLength)){n.next=19;break}i=null==o?0:o+1,c=[],l["a"].SEARCHED_USERS_PAGE_SIZE+o+1;case 7:if(!(i<l["a"].SEARCHED_USERS_PAGE_SIZE+o+1)){n.next=14;break}if(i!=e.getters.getNearbyUsersIDsLength){n.next=10;break}return n.abrupt("break",14);case 10:c.push(r[i]);case 11:i++,n.next=7;break;case 14:return o=i-1,n.next=17,e.dispatch("database/getMultipleProfilesByUID",c).then((function(e){e.forEach((function(e){var n=!0;if(null==s.username||void 0==s.username||""==s.username||e.username.startsWith(s.username)||(n=!1),("M"===s.gender&&"M"!==e.gender||"W"===s.gender&&"W"!==e.gender)&&(n=!1),s.ageRange[0]>l["a"].MIN_USER_AGE||s.ageRange[1]<l["a"].MAX_USER_AGE){if(s.ageRange[0]>l["a"].MIN_USER_AGE){var a=new Date;a.setFullYear(a.getFullYear()-s.ageRange[0]),a.setHours(0,0,0),new Date(e.birthDate.toDate().setHours(0,0,0))>=new Date(a)&&(n=!1)}if(s.ageRange[1]<l["a"].MAX_USER_AGE){var r=new Date;r.setFullYear(r.getFullYear()-s.ageRange[1]-1),r.setHours(0,0,0),new Date(e.birthDate.toDate().setHours(0,0,0))<=new Date(r)&&(n=!1)}}if("languageToLearn"==s.language.filterBy&&"all"!=s.language.languageToLearn){var o=e.languagesToLearn.findIndex((function(e){return e==s.language.languageToLearn}));-1==o&&(n=!1)}else if("knownLanguage"==s.language.filterBy&&"all"!=s.language.knownLanguage){var i=e.knownLanguages.findIndex((function(e){return e==s.language.knownLanguage}));-1==i&&(n=!1)}e.registrationCompleted||(n=!1),n&&t(!0)}))})).catch((function(e){a(e)}));case 17:n.next=3;break;case 19:t(!1);case 20:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},getNearbyUsersProfiles:function(e){return new Promise(function(){var n=Object(w["a"])(regeneratorRuntime.mark((function n(t,a){var r,s,o,i,c,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=0,s=e.getters.getNearbyUsersIDs,o=e.getters.getFilters;case 3:if(!(r<l["a"].SEARCHED_USERS_PAGE_SIZE&&e.getters.getLastUserShowed+1<e.getters.getNearbyUsersIDsLength)){n.next=20;break}i=void 0,c=e.getters.getLastUserShowed,null==c?(i=0,c=0):i=c+1,u=[];case 8:if(!(i<l["a"].SEARCHED_USERS_PAGE_SIZE+c)){n.next=15;break}if(i!=e.getters.getNearbyUsersIDsLength){n.next=11;break}return n.abrupt("break",15);case 11:u.push(s[i]);case 12:i++,n.next=8;break;case 15:return e.commit("setLastUserShowed",i-1),n.next=18,e.dispatch("database/getMultipleProfilesByUID",u).then(function(){var n=Object(w["a"])(regeneratorRuntime.mark((function n(t){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.forEach((function(n){var t=!0;if(null==o.username||void 0==o.username||""==o.username||n.username.startsWith(o.username)||(t=!1),("M"===o.gender&&"M"!==n.gender||"W"===o.gender&&"W"!==n.gender)&&(t=!1),o.ageRange[0]>l["a"].MIN_USER_AGE||o.ageRange[1]<l["a"].MAX_USER_AGE){if(o.ageRange[0]>l["a"].MIN_USER_AGE){var a=new Date;a.setFullYear(a.getFullYear()-o.ageRange[0]),a.setHours(0,0,0),new Date(n.birthDate.toDate().setHours(0,0,0))>=new Date(a)&&(t=!1)}if(o.ageRange[1]<l["a"].MAX_USER_AGE){var s=new Date;s.setFullYear(s.getFullYear()-o.ageRange[1]-1),s.setHours(0,0,0),new Date(n.birthDate.toDate().setHours(0,0,0))<=new Date(s)&&(t=!1)}}if("languageToLearn"==o.language.filterBy&&"all"!=o.language.languageToLearn){var i=n.languagesToLearn.findIndex((function(e){return e==o.language.languageToLearn}));-1==i&&(t=!1)}else if("knownLanguage"==o.language.filterBy&&"all"!=o.language.knownLanguage){var c=n.knownLanguages.findIndex((function(e){return e==o.language.knownLanguage}));-1==c&&(t=!1)}t&&(e.commit("addUser",n),e.commit("addSearchedUserID",n.id),r++)}));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){a(e)}));case 18:n.next=3;break;case 20:t();case 21:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},resetSearchedUsers:function(e){return new Promise((function(n,t){e.commit("resetSearchedUsersIDs"),e.commit("setLastUserShowed",null),n()}))},setFilters:function(e,n){return new Promise((function(t,a){e.commit("setGenderFilter",n.gender),e.commit("setAgeRangeFilter",n.ageRange),e.commit("setLanguageFilter",n.language),e.commit("setMaxDistanceFilter",n.maxDistance),e.commit("setLocationFilter",n.location),t()}))},getUserByID:function(e,n){return new Promise((function(t,a){e.dispatch("database/getProfileByUID",n).then((function(n){n?(e.commit("addUser",n),t(n)):t(!1)})).catch((function(e){console.log("Error getting user by it's id in firebase."),a(e)}))}))},resetFilters:function(e){return new Promise((function(n,t){e.commit("setGenderFilter","O"),e.commit("setAgeRangeFilter",[l["a"].MIN_USER_AGE,l["a"].MAX_USER_AGE]),e.commit("setLanguageFilter",{filterBy:"languageToLearn",knownLanguage:"all",languageToLearn:"all"}),e.commit("setLocationFilter",null),e.commit("setNearbyUsersIDs",null),e.commit("setNearbyUsersIDs",null),e.commit("setMaxDistanceFilter",3),e.commit("setSearchByUsernameFilter",null);var a=e.getters.getFilters;a["maxDistance"]=3,n(a)}))}}};function x(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function X(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?x(t,!0).forEach((function(n){Object(o["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):x(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}a["a"].use(i["a"]);var V={namespaced:!0,modules:{database:y,users:F},state:{id:null,name:null,lastName:null,email:null,chats:[],role:"user",username:null,birthDate:null,gender:null,description:null,avgRating:null,numRatings:null,knownLanguages:null,languagesToLearn:null,profileImg:null,location:null,ratings:null,genderOptions:{M:{text:l["a"].TEXT_MAN,img:"img/genders/male.svg",defaultProfileImg:"img/defaultUserImages/male-defaultUserImage.svg"},W:{text:l["a"].TEXT_WOMAN,img:"img/genders/female.svg",defaultProfileImg:"img/defaultUserImages/female-defaultUserImage.svg"},O:{text:l["a"].TEXT_OTHER,img:"img/genders/other.svg",defaultProfileImg:"img/defaultUserImages/defaultUserImage.svg"}},languageOptions:{de:{text:"Alemán",img:"img/flags/de.svg"},zh:{text:"Chino",img:"img/flags/zh.svg"},es:{text:"Español",img:"img/flags/es.svg"},fr:{text:"Francés",img:"img/flags/fr.svg"},en:{text:"Inglés",img:"img/flags/en.svg"},it:{text:"Italiano",img:"img/flags/it.svg"},ja:{text:"Japonés",img:"img/flags/ja.svg"},pt:{text:"Portugués",img:"img/flags/pt.svg"},all:{text:"Cualquier idioma",img:"img/flags/all.svg"}}},getters:{getName:function(e){return e.name},getID:function(e){return e.id},getLastName:function(e){return e.lastName},getEmail:function(e){return e.email},getRole:function(e){return e.role},getChats:function(e){return e.chats},getProfile:function(e){var n={};return e.username&&(n=X({username:e.username},n)),e.birthDate&&(n=X({birthDate:e.birthDate},n)),e.gender&&(n=X({gender:e.gender},n)),e.description&&(n=X({description:e.description},n)),e.profileImg&&(n=X({profileImg:e.profileImg},n)),e.knownLanguages&&(n=X({knownLanguages:e.knownLanguages},n)),e.languagesToLearn&&(n=X({languagesToLearn:e.languagesToLearn},n)),n=X({avgRating:e.avgRating,numRatings:e.numRatings},n),n},getUsername:function(e){return e.username},getBirthDate:function(e){return e.birthDate},getGender:function(e){return e.gender},getDescription:function(e){return e.description},getProfileImg:function(e){return e.profileImg},getAvgRating:function(e){return e.avgRating},getNumRatings:function(e){return e.numRatings},getKnownLanguages:function(e){return e.knownLanguages},getLanguagesToLearn:function(e){return e.languagesToLearn},getGenderTextByID:function(e){return function(n){return e.genderOptions[n].text}},getGenderImgByID:function(e){return function(n){return e.genderOptions[n].img}},getGenderDefaultProfileImgByUserGender:function(e){return null==e.gender?e.genderOptions["O"].defaultProfileImg:e.genderOptions[e.gender].defaultProfileImg},getGenderOptionsAsArray:function(e,n){return Object.keys(e.genderOptions).map((function(e){var t=n.getGenderTextByID(e),a=n.getGenderImgByID(e);return new Object({id:e,text:t,img:a})}))},getLanguageTextByID:function(e){return function(n){return e.languageOptions[n].text}},getLanguageImgByID:function(e){return function(n){return e.languageOptions[n].img}},getLanguageOptionsAsArray:function(e,n){return Object.keys(e.languageOptions).map((function(e){var t=n.getLanguageTextByID(e),a=n.getLanguageImgByID(e);return new Object({id:e,text:t,img:a})}))},getFormattedDateInTextMonth:function(){return function(e){var n=new Date(e);return n.getDate()+" "+l["a"].TEXT_OF+" "+l["a"].MONTHS_OF_THE_YEAR_IN_TEXT[n.getMonth()]+" "+l["a"].TEXT_OF+" "+n.getFullYear()}},getLanguageFromLanguageOptionsByID:function(e){return function(n){return e.languageOptions[n]}},getLocation:function(e){return e.location},getRatings:function(e){return e.ratings},getRating:function(e){return function(n){return e.ratings?e.ratings[n]:null}}},mutations:{setIDe:function(e,n){e.id=n},setName:function(e,n){e.name=n},setLastName:function(e,n){e.lastName=n},setEmail:function(e,n){e.email=n},setRole:function(e,n){e.role=n},setChats:function(e,n){e.chats=n},setAccount:function(e,n){n.hasOwnProperty("email")&&(e.email=n.email),n.hasOwnProperty("name")&&(e.name=n.name),n.hasOwnProperty("lastName")&&(e.lastName=n.lastName),n.hasOwnProperty("profileImg")&&(e.role=n.role),n.hasOwnProperty("id")&&(e.id=n.id),n.hasOwnProperty("chats")&&(e.chats=n.chats)},setUsername:function(e,n){e.username=n},setBirthDate:function(e,n){e.birthDate=n},setGender:function(e,n){e.gender=n},setDescription:function(e,n){e.description=n},setAvgRating:function(e,n){e.avgRating=n},setNumRatings:function(e,n){e.numRatings=n},setKnownLanguages:function(e,n){e.knownLanguages=n},setLanguagesToLearn:function(e,n){e.languagesToLearn=n},setProfileImg:function(e,n){e.profileImg=n},setRatings:function(e,n){e.ratings=n},setRating:function(e,n){null==e.ratings&&(e.ratings={}),e.ratings[n.id]=n.rating},setProfile:function(e,n){n&&(n.hasOwnProperty("username")&&(e.username=n.username),n.hasOwnProperty("birthDate")&&(e.birthDate=n.birthDate),n.hasOwnProperty("gender")&&(e.gender=n.gender),n.hasOwnProperty("description")&&(e.description=n.description),n.hasOwnProperty("avgRating")&&(e.avgRating=n.avgRating),n.hasOwnProperty("numRatings")&&(e.numRatings=n.numRatings),n.hasOwnProperty("knownLanguages")&&(e.knownLanguages=n.knownLanguages),n.hasOwnProperty("languagesToLearn")&&(e.languagesToLearn=n.languagesToLearn),n.hasOwnProperty("profileImg")&&(e.profileImg=n.profileImg))},resetState:function(e){e.id=null,e.name=null,e.lastName=null,e.email=null,e.role="user",e.chats=[],e.username=null,e.birthDate=null,e.gender=null,e.description=null,e.avgRating=null,e.numRatings=null,e.knownLanguages=null,e.languagesToLearn=null,e.profileImg=null,e.ratings=null,e.location=null},setLocation:function(e,n){e.location=n}},actions:{initState:function(e){return new Promise((function(n,t){e.dispatch("database/getProfile").then((function(a){e.commit("setProfile",a),e.dispatch("database/getAccount").then((function(a){e.commit("setAccount",a),e.dispatch("getRatings").then((function(){n()})).catch((function(e){t(e)})),n()})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))}))},resetState:function(e){return new Promise((function(n,t){e.commit("resetState"),n()}))},createAccount:function(e,n){return new Promise((function(t,a){e.dispatch("database/createAccount",n).then((function(){e.dispatch("database/setPersistance").then((function(){e.dispatch("database/setAccount",n).then((function(){e.commit("setAccount",n),t()})).catch((function(e){console.log("Error creating user account."),a(e)}))})).catch((function(e){a(e)}))})).catch((function(e){a(e)}))}))},generateNotificationToken:function(e){return new Promise((function(n,t){e.dispatch("database/generatePushNotificationToken").then((function(){n()})).catch((function(e){t(e)}))}))},updateAccountNameAndLastName:function(e,n){return new Promise((function(t,a){e.dispatch("database/updateAccountData",n).then((function(){n.hasOwnProperty("name")&&e.commit("setName",n.name),n.hasOwnProperty("lastName")&&e.commit("setLastName",n.lastName),t()})).catch((function(e){a(e)}))}))},updateAccountEmail:function(e,n){return new Promise((function(t,a){e.dispatch("database/updateAccountEmail",n).then((function(){e.commit("setEmail",n),t()})).catch((function(e){a(e)}))}))},updateAccountPassword:function(e,n){return new Promise((function(t,a){e.dispatch("database/updateAccountPassword",n).then((function(){t()})).catch((function(e){a(e)}))}))},login:function(e,n){return new Promise((function(t,a){e.dispatch("database/login",n).then((function(){e.commit("setAccount",n),e.dispatch("database/setPersistance").then((function(){t()})).catch((function(e){a(e)}))})).catch((function(e){a(e)}))}))},isUserLogged:function(e){return new Promise((function(n,t){e.dispatch("database/isUserAuth").then((function(e){n(e)})).catch((function(e){t(e)}))}))},logout:function(e){return new Promise((function(n,t){e.dispatch("database/logout").then((function(){e.dispatch("resetAppState",null,{root:!0}),n()})).catch((function(e){t(e)}))}))},sendEmailVerification:function(e){return new Promise((function(n,t){e.dispatch("database/sendEmailVerification").then((function(){n()})).catch((function(e){console.log("Error sending verification email."),t(e)}))}))},sendPasswordResetEmail:function(e,n){return new Promise((function(t,a){e.dispatch("database/sendPasswordResetEmail",n).then((function(){t()})).catch((function(e){console.log("Error sending password email."),a(e)}))}))},checkIfEmailIsVerified:function(e){return new Promise((function(n,t){e.dispatch("database/isEmailVerified").then((function(e){n(e)})).catch((function(e){console.log("Error checking if email is verified."),t(e)}))}))},checkIfUsernameIsAlreadyRegistered:function(e,n){return new Promise((function(t,a){e.dispatch("database/getProfileByUsername",n).then((function(e){t(!!e)})).catch((function(e){console.log("Error checking if username is already registered."),a(e)}))}))},createProfile:function(e,n){return new Promise((function(t,a){e.dispatch("checkIfUsernameIsAlreadyRegistered",n.username).then((function(r){r?a(l["a"].ERROR_ALREADY_AN_ACCOUNT_WITH_THIS_USERNAME):e.dispatch("database/setProfile",n).then((function(){e.commit("setUsername",n.username),e.commit("setBirthDate",n.birthDate),e.commit("setGender",n.gender),e.commit("setDescription",n.description),e.commit("setAvgRating",0),e.commit("setNumRatings",0),t()})).catch((function(e){console.log("Error creating user profile."),a(e)}))})).catch((function(e){a(e)}))}))},updateProfile:function(e,n){return new Promise((function(t,a){e.dispatch("database/updateProfile",n).then(Object(w["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n.hasOwnProperty("username")&&e.commit("setUsername",n.username),n.hasOwnProperty("description")&&e.commit("setDescription",n.description),n.hasOwnProperty("gender")&&e.commit("setGender",n.gender),n.hasOwnProperty("birthDate")&&e.commit("setBirthDate",n.birthDate),n.hasOwnProperty("knownLanguages")&&e.commit("setKnownLanguages",n.knownLanguages),n.hasOwnProperty("languagesToLearn")&&e.commit("setLanguagesToLearn",n.languagesToLearn),!n.hasOwnProperty("profileImg")){r.next=9;break}return r.next=9,e.dispatch("setProfileImg",n.profileImg).catch((function(e){a(e)}));case 9:t();case 10:case"end":return r.stop()}}),r)})))).catch((function(e){a(e)}))}))},setLanguages:function(e,n){return new Promise((function(t,a){e.dispatch("database/setLanguages",n).then((function(){e.commit("setKnownLanguages",n.knownLanguages),e.commit("setLanguagesToLearn",n.languagesToLearn),t()})).catch((function(e){console.log("Error setting user languages."),a(e)}))}))},setProfileImg:function(e,n){return new Promise((function(t,r){a["a"].nextTick((function(){e.dispatch("database/uploadProfileImg",n).then((function(n){e.dispatch("database/setProfileImg",n).then((function(){e.commit("setProfileImg",n),t()})).catch((function(e){console.log("Error setting user profile image."),console.error(e),r(e)}))})).catch((function(e){console.log("Error uploading user profile image."),r(e)}))}))}))},setRegistrationCompleted:function(e,n){return new Promise((function(t,a){e.dispatch("database/setRegistrationCompleted",n).then((function(){t()})).catch((function(e){console.log("Error updating user registration state."),a(e)}))}))},getRegistrationState:function(e){return new Promise((function(n,t){e.dispatch("database/getProfile").then((function(a){e.dispatch("checkRegistrationState",a).then((function(t){e.commit("setProfile",a),n(t)})).catch((function(e){console.log(e),t(e)}))})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_PROBLEM)}))}))},checkRegistrationState:function(e,n){return new Promise((function(t,a){e.dispatch("checkIfEmailIsVerified").then((function(e){e?n&&n.hasOwnProperty("username")&&n.hasOwnProperty("gender")&&n.hasOwnProperty("description")&&n.hasOwnProperty("avgRating")&&n.hasOwnProperty("numRatings")?n.hasOwnProperty("knownLanguages")&&n.hasOwnProperty("languagesToLearn")?n.hasOwnProperty("profileImg")?t("dashboard"):t("set-your-profile-image"):t("fill-your-languages"):t("fill-your-profile-info"):t("email-verification")})).catch((function(e){console.error(e),a(l["a"].ERROR_GENERIC_PROBLEM)}))}))},getCurrentLocation:function(){return new Promise((function(e,n){try{navigator.geolocation.getCurrentPosition((function(n){e({lat:n.coords.latitude,lng:n.coords.longitude})}),(function(e){console.error(e),n(l["a"].ERROR_GETTING_CURRENT_LOCATION)}))}catch(t){console.error(t),n(l["a"].ERROR_GETTING_CURRENT_LOCATION)}}))},getRatings:function(e){return new Promise((function(n,t){e.dispatch("database/getRatings").then((function(t){e.commit("setRatings",t),n()})).catch((function(e){console.log("Error retrieving user ratings."),t(e)}))}))},rateUser:function(e,n){return new Promise((function(t,a){e.dispatch("database/setRating",n).then((function(a){e.commit("setRating",n),e.commit("users/addRating",n),t()})).catch((function(e){console.log(e),console.log("Error rating user."),a(e)}))}))},getLocation:function(e){return new Promise((function(n,t){e.dispatch("getCurrentLocation").then((function(t){e.commit("setLocation",t),e.dispatch("database/updateUserLocation",t).then((function(){n(t)})).catch((function(){n(t)}))})).catch((function(a){console.error(a),e.dispatch("database/getLocation").then((function(t){e.commit("setLocation",t),n(t)})).catch((function(e){t(e)}))}))}))}}},j=t("8cdb"),H=t.n(j);function W(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?W(t,!0).forEach((function(n){Object(o["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):W(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}a["a"].use(i["a"]);var q={namespaced:!0,modules:{user:V,users:F,database:y,permissions:B},state:{events:{},eventsToShowIDs:[],mapEventsToShowIDs:[],lastEventShowed:null,languageInvolvedFilter:"all",eventsTab:0},getters:{getLanguageInvolvedFilter:function(e){return e.languageInvolvedFilter},getFilters:function(e){return{languageInvolved:e.languageInvolvedFilter}},getEvents:function(e){return e.events},getEventsTab:function(e){return e.eventsTab},getEventByID:function(e){return function(n){return e.events[n]}},getEventsToShow:function(e){var n=[];return e.eventsToShowIDs.forEach((function(t){n.push(Y({id:t},e.events[t]))})),n},getMapEventsToShow:function(e){var n=[];return e.mapEventsToShowIDs.forEach((function(t){n.push(Y({id:t},e.events[t]))})),n},getLastEventShowed:function(e){return e.lastEventShowed},amIParticipating:function(e){return function(n){var t=null;return e.events[n.eventID]?(t=e.events[n.eventID].participants.find((function(e){return e==n.userID})),void 0!=t):null}}},mutations:{setLanguageInvolvedFilter:function(e,n){e.languageInvolvedFilter=n},setEventsTab:function(e,n){e.eventsTab=n},resetState:function(e){e.events={},e.eventsToShowIDs.splice(0,e.eventsToShowIDs.length),e.mapEventsToShowIDs.splice(0,e.mapEventsToShowIDs.length),e.lastEventShowed=null,e.languageInvolvedFilter="all"},resetEventsToShowIDs:function(e){e.eventsToShowIDs.splice(0,e.eventsToShowIDs.length),e.lastEventShowed=null},addEvent:function(e,n){e.events[n.id]=n},addParticipantToEvent:function(e,n){-1==e.events[n.eventID].participants.findIndex((function(e){return e==n.userID}))&&e.events[n.eventID].participants.push(n.userID)},removeParticipantFromEvent:function(e,n){var t=e.events[n.eventID].participants.findIndex((function(e){return e==n.userID}));e.events[n.eventID].participants.splice(t,1)},addEventToShow:function(e,n){e.eventsToShowIDs.push(n)},addMapEventToShow:function(e,n){e.mapEventsToShowIDs.push(n)},setEventsToShowIDs:function(e,n){e.eventsToShowIDs=n},setLastEventShowed:function(e,n){e.lastEventShowed=n}},actions:{initState:function(e){return new Promise((function(n,t){e.dispatch("resetState").then((function(){e.dispatch("getAllEvents").then((function(){n()})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))}))},getEvents:function(e){return new Promise((function(n,t){var a=e.getters.getFilters;e.dispatch("database/getNextEventsPage",{lastEventShowed:e.getters.getLastEventShowed,limit:l["a"].EVENTS_PAGE_SIZE,filters:a}).then((function(r){e.commit("setLastEventShowed",r.newLastEventShowed),r.events.forEach((function(n){var t=e.getters["user/getLocation"],a=null,r={lat:n.location.coordinates._lat,lng:n.location.coordinates._long},s=n.location;s["coordinates"]=r,n["location"]=s,null!=t&&(a=H()(n.location.coordinates,t)),n=Y({},n,{distance:a/1e3}),e.commit("addEvent",n),e.commit("addEventToShow",n.id)})),r.events.length>0?e.dispatch("database/isNextEventsPageEmpty",{lastEventShowed:e.getters.getLastEventShowed,limit:l["a"].EVENTS_PAGE_SIZE,filters:a}).then((function(e){n(!e)})).catch((function(e){t(e)})):n(!1)})).catch((function(e){t(e)}))}))},getAllEvents:function(e){return new Promise((function(n,t){e.getters.getFilters;e.dispatch("database/getEventsToBeCelebrated").then((function(t){t.forEach((function(n){e.getters["user/getLocation"];var t={lat:n.location.coordinates._lat,lng:n.location.coordinates._long},a=n.location;a["coordinates"]=t,n["location"]=a,e.commit("addEvent",n),e.commit("addMapEventToShow",n.id)})),n()})).catch((function(e){t(e)}))}))},getEventParticipants:function(e,n){return new Promise((function(t,a){var r=e.getters.getEventByID(n);e.dispatch("database/getMultipleProfilesByUID",r.participants).then((function(n){n.forEach((function(n){e.commit("users/addUser",n)})),t(n)})).catch((function(e){a(e)}))}))},resetState:function(e){return new Promise((function(n,t){e.commit("resetState"),n()}))},addParticipantToEvent:function(e,n){return new Promise((function(t,a){e.dispatch("database/addParticipantToEvent",n).then((function(a){e.commit("addParticipantToEvent",{eventID:n,userID:a}),t()})).catch((function(e){console.log(e),a(e)}))}))},removeParticipantFromEvent:function(e,n){return new Promise((function(t,a){e.dispatch("database/removeParticipantFromEvent",n).then((function(a){e.commit("removeParticipantFromEvent",{eventID:n,userID:a}),t()})).catch((function(e){a(e)}))}))},getEventByID:function(e,n){return new Promise((function(t,a){e.dispatch("database/getEventByID",n).then((function(n){if(n){var a=e.getters["user/getLocation"],r=null,s={lat:n.location.coordinates._lat,lng:n.location.coordinates._long},o=n.location;o["coordinates"]=s,n["location"]=o,null!=a&&(r=H()(n.location.coordinates,a)),n=Y({},n,{distance:r/1e3}),e.commit("addEvent",n),t(n)}else t(null)})).catch((function(e){console.log("Error getting event by it's id in firebase."),a(e)}))}))}}};t("ac4d"),t("8a81"),t("55dd");function K(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?K(t,!0).forEach((function(n){Object(o["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}a["a"].use(i["a"]);var z={namespaced:!0,modules:{user:V,users:F,database:y,permissions:B},state:{chats:{},chatsToShowIDs:[],chatListListener:null,chatMessagesListeners:[]},getters:{getChatByID:function(e){return function(n){return e.chats[n]}},getChatsToShowIDs:function(e){return e.chatsToShowIDs},getChatMessagesByChatID:function(e,n){return function(n){return void 0!=e.chats[n]?e.chats[n].messages:[]}},getUnreadMessagesByChatID:function(e,n){return function(t){var a,r=n["user/getID"],s=[];if(void 0!=e.chats[t])for(a=e.chats[t].messages.length-1;a>=0;a--)if(e.chats[t].messages[a].sender==r||e.chats[t].messages[a].read){if(e.chats[t].messages[a].sender!=r&&e.chats[t].messages[a].read)break;if(e.chats[t].messages[a].sender==r)break}else s.push(e.chats[t].messages[a].id);return s}},getUnreadMessages:function(e,n){var t=0;return e.chatsToShowIDs.forEach((function(e){t+=n.getUnreadMessagesByChatID(e).length})),t},getChatsToShow:function(e){var n=[];return e.chatsToShowIDs.forEach((function(t){var a={};a.users=e.chats[t].users,a.id=e.chats[t].id,a.lastMessage=e.chats[t].messages[e.chats[t].messages.length-1],n.push(a)})),n},getUserByChatID:function(e,n){return function(t){var a;return a=e.chats[t].users[0]==n["user/getID"]?e.chats[t].users[1]:e.chats[t].users[0],n["users/getUserByID"](a)}},getNotReadMessagesCountByChatID:function(e,n){return function(t){var a,r=0,s=n["user/getID"];for(a=e.chats[t].messages.length-1;a>=0;a--)if(e.chats[t].messages[a].sender==s||e.chats[t].messages[a].read){if(e.chats[t].messages[a].sender!=s&&e.chats[t].messages[a].read)break;if(e.chats[t].messages[a].sender==s)break}else r++;return r}}},mutations:{resetState:function(e){e.chats={},e.chatsToShowIDs.splice(0,e.chatsToShowIDs.length),null!=e.chatListListener&&void 0!=e.chatListListener&&(e.chatListListener(),e.chatListListener=null),e.chatMessagesListeners.forEach((function(e){null!=e&&void 0!=e&&e()})),e.chatMessagesListeners.splice(0,e.chatMessagesListeners.length)},addChatMessagesListener:function(e,n){e.chatMessagesListeners.push(n)},addChat:function(e,n){(!e.chats[n.id]||n.messages.length>e.chats[n.id].messages.length)&&a["a"].set(e.chats,n.id,n)},updateChatMessages:function(e,n){for(var t=function(t){var r=n.messages.findIndex((function(a){return a.id===e.chats[n.chatID].messages[t].id}));if(-1!=r&&(a["a"].set(e.chats[n.chatID].messages,t,n.messages[r]),n.messages.splice(r,1),0==n.messages.length))return"break"},r=e.chats[n.chatID].messages.length-1;r>=0;r--){var s=t(r);if("break"===s)break}},sortChatMessagesByDate:function(e,n){function t(e,n){var t=e.date,a=n.date;return null===t?1:null===a?-1:a<t?1:a>t?-1:0}e.chats[n].messages.sort(t)},addChatToShow:function(e,n){-1==e.chatsToShowIDs.findIndex((function(e){return e==n}))&&e.chatsToShowIDs.push(n)},sortChatsToShowByLastMessage:function(e){function n(n,t){var a=e.chats[n].messages[e.chats[n].messages.length-1].date,r=e.chats[t].messages[e.chats[t].messages.length-1].date;return a<r?1:a>r?-1:0}e.chatsToShowIDs.sort(n)},setChatListListener:function(e,n){e.chatListListener=n},pushChatMessages:function(e,n){n.messages.forEach((function(t){if(null!=t.date&&void 0!=t.date)if(0==e.chats[n.chatID].messages.length)a["a"].set(e.chats[n.chatID].messages,0,t);else{for(var r=!1,s=e.chats[n.chatID].messages.length-1;s>=0;s--){if(null!=t.date&&void 0!=t.date&&(e.chats[n.chatID].messages[s].date<t.date&&!e.chats[n.chatID].messages[s+1]&&e.chats[n.chatID].messages[s].id!=t.id||e.chats[n.chatID].messages[s].date<t.date&&e.chats[n.chatID].messages[s+1].date>t.date&&e.chats[n.chatID].messages[s].id!=t.id&&e.chats[n.chatID].messages[s+1].id!=t.id)){e.chats[n.chatID].messages.splice(s+1,0,t),r=!0;break}if(null!=t.date&&void 0!=t.date&&0==s&&e.chats[n.chatID].messages[s].date>t.date&&e.chats[n.chatID].messages[s].id!=t.id){e.chats[n.chatID].messages.splice(s,0,t),r=!0;break}}r||e.chats[n.chatID].messages.push(t)}}))}},actions:{resetState:function(e){return new Promise((function(n,t){e.commit("resetState"),n()}))},initState:function(e,n){return new Promise((function(n,t){e.dispatch("createChatListeners",e.getters["user/getChats"]).then((function(){n()})).catch((function(e){t(e)}))}))},manageChatListChange:function(e,n){return new Promise(function(){var t=Object(w["a"])(regeneratorRuntime.mark((function t(a,r){var s,o,i,c,u,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=!0,o=!1,i=void 0,t.prev=3,c=regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t=l.value,-1!=e.getters.getChatsToShowIDs.findIndex((function(e){return e==t}))||e.state.chats.hasOwnProperty(t)&&0!=e.state.chats[t].messages.length){n.next=4;break}return n.next=4,e.dispatch("database/getChatByID",t).then(function(){var n=Object(w["a"])(regeneratorRuntime.mark((function n(a){var s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=Z({},a,{messages:[]}),s=a.users[0]==e.getters["user/getID"]?a.users[1]:a.users[0],n.next=4,e.dispatch("users/getUserByID",s).then((function(){e.commit("addChat",a)})).catch((function(e){r(e),cch}));case 4:return n.next=6,e.dispatch("database/createChatMessagesListener",t).then((function(){e.commit("addChatToShow",a.id),e.commit("sortChatsToShowByLastMessage")})).catch((function(e){r(e)}));case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(e){r(e)}));case 4:case"end":return n.stop()}}),n)})),u=n.chats[Symbol.iterator]();case 6:if(s=(l=u.next()).done){t.next=11;break}return t.delegateYield(c(),"t0",8);case 8:s=!0,t.next=6;break;case 11:t.next=17;break;case 13:t.prev=13,t.t1=t["catch"](3),o=!0,i=t.t1;case 17:t.prev=17,t.prev=18,s||null==u.return||u.return();case 20:if(t.prev=20,!o){t.next=23;break}throw i;case 23:return t.finish(20);case 24:return t.finish(17);case 25:a();case 26:case"end":return t.stop()}}),t,null,[[3,13,17,25],[18,,20,24]])})));return function(e,n){return t.apply(this,arguments)}}())},manageChatMessagesChange:function(e,n){return new Promise((function(t,a){e.commit("addChatMessagesListener",n.listener);var r=[],s=[],o=[];n.messages.forEach((function(e){"added"==e.change&&e.date?r.push(e):"modified"==e.change&&e.read&&e.date?s.push(e):"modified"==e.change&&!e.read&&e.date&&o.push(e)})),r.length>0&&e.commit("pushChatMessages",{chatID:n.id,messages:r}),o.length>0&&e.commit("pushChatMessages",{chatID:n.id,messages:o}),s.length>0&&e.commit("updateChatMessages",{chatID:n.id,messages:s}),e.commit("sortChatsToShowByLastMessage"),t()}))},setChatMessagesToReadByChatID:function(e,n){return new Promise((function(t,a){var r=e.getters.getUnreadMessagesByChatID(n);e.dispatch("database/setMessagesToRead",{chatID:n,messages:r}).catch((function(e){a(e)}))}))},sendNewChatMessage:function(e,n){return new Promise((function(t,a){var r,s=e.getters.getChatByID(n.chatID);r=0==e.getters.getChatByID(n.chatID).messages.length?e.dispatch("database/addChat",{id:n.chatID,users:s.users}):Promise.resolve(),r.then((function(){e.dispatch("database/addMessagesToChat",{chatID:n.chatID,message:{sender:e.getters["user/getID"],text:n.messageText}}).then((function(){t()})).catch((function(e){a(e)}))})).catch((function(e){a(e)}))}))},createChatListeners:function(e){return new Promise((function(n,t){e.dispatch("database/createAccountListener",e.getters["user/getID"]).then((function(){null!=e.state.chatListListener&&void 0!=e.state.chatListListener&&e.state.chatListListener(),e.commit("setChatListListener",V.listener),n()})).catch((function(e){t(e)}))}))}}};function J(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function Q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?J(t,!0).forEach((function(n){Object(o["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):J(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}a["a"].use(i["a"]);var $={namespaced:!0,modules:{database:y,permissions:B,users:F,user:V},state:{lastUserShowed:-1,rankingUsers:[],rankingUsersIDs:[],rankingUser:null},getters:{getRankingUsersToShow:function(e,n){var t=[],a=0;return e.rankingUsersIDs.forEach((function(r){var s=Q({},n["users/getUserByID"](r));s["score"]=e.rankingUsers[a].score,s["position"]=e.rankingUsers[a].position,t.push(s),a++})),t},getLastUserShowed:function(e){return e.lastUserShowed},getRankedUserByIndex:function(e){return function(n){return e.rankingUsers[n]}},getRankingUsers:function(e){return e.rankingUsers}},mutations:{resetState:function(e){e.lastUserShowed=-1,e.rankingUsers.splice(0,e.rankingUsers.length),e.rankingUsersIDs.splice(0,e.rankingUsersIDs.length),e.rankingUser=null},setRankingUser:function(e,n){e.rankingUser=n},setRankingUsers:function(e,n){n.forEach((function(n){e.rankingUsers.push(n)}))},resetRankingUsers:function(e,n){e.rankingUsers.splice(0,e.rankingUsers.length)},resetRankingUsersIDs:function(e,n){e.rankingUsersIDs.splice(0,e.rankingUsersIDs.length)},setLastUserShowed:function(e,n){e.lastUserShowed=n},addRankingUserID:function(e,n){e.rankingUsersIDs.push(n)}},actions:{initState:function(e){return new Promise((function(n,t){e.dispatch("resetState").then((function(){e.dispatch("getRankingUsers").then((function(){n()})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))}))},getRankingUsers:function(e){return new Promise((function(n,t){e.dispatch("database/getTop100RankingUsers").then((function(a){var r=e.getters["user/getID"],s=a.findIndex((function(e){return e.id==r}));e.commit("setRankingUsers",a),-1==s?e.dispatch("database/getUserRankingPositionByID",r).then((function(t){e.commit("setRankingUser",t),n()})).catch((function(e){t(e)})):n()})).catch((function(e){t(e)}))}))},getPagedRankingUsers:function(e){return new Promise(function(){var n=Object(w["a"])(regeneratorRuntime.mark((function n(t,a){var r,s,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=e.getters.getLastUserShowed+1,s=r+l["a"].RANKING_PAGE_SIZE,o=regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t=e.getters.getRankedUserByIndex(r),n.next=3,e.dispatch("users/getUserByID",t.id).then((function(){e.commit("addRankingUserID",t.id)})).catch((function(e){a(e)}));case 3:r++;case 4:case"end":return n.stop()}}),n)}));case 3:if(!(r<s&&r<e.getters.getRankingUsers.length)){n.next=7;break}return n.delegateYield(o(),"t0",5);case 5:n.next=3;break;case 7:e.commit("setLastUserShowed",r-1),r<e.getters.getRankingUsers.length?t(!0):t(!1);case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},areThereMoreRankingUsersToShow:function(e){return new Promise(function(){var n=Object(w["a"])(regeneratorRuntime.mark((function n(t,a){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:r=e.getters.getLastUserShowed+1,r<e.getters.getRankingUsers.length?t(!0):t(!1);case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},resetState:function(e){return new Promise((function(n,t){e.commit("resetState"),n()}))}}};function ee(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function ne(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ee(t,!0).forEach((function(n){Object(o["a"])(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ee(t).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}a["a"].use(i["a"]);var te=new i["a"].Store({modules:{user:V,users:F,events:q,chats:z,ranking:$,database:y,permissions:B},state:{appInfoLoaded:!1,allAvailableLanguages:{de:"Alemán",zh:"Chino",es:"Español",fr:"Francés",en:"Inglés",it:"Italiano",ja:"Japonés",pt:"Portugués",all:"Cualquier idioma"},allAvailableGenders:{M:{name:"Hombre",img:"img/genders/male.svg"},W:{name:"Mujer",img:"img/genders/female.svg"}},defaultInfo:{userImage:"img/defaultUserImages/defaultUserImage.svg",maleUserImage:"img/defaultUserImages/male-defaultUserImage.svg",femaleUserImage:"img/defaultUserImages/female-defaultUserImage.svg",profileHeaderImage:"img/backgrounds/user_profile_header.png"},searchInfo:{lastVisible:null,userIDs:[],filtering:{genderW:!0,genderM:!0,ageRange:[l["a"].MIN_USER_AGE,l["a"].MAX_USER_AGE],maxDistance:3,maxDistanceRanges:[5e3,1e4,2e4,null],maxDistanceRangesText:[l["a"].TEXT_5_KM,l["a"].TEXT_10_KM,l["a"].TEXT_10_KM,"∞"],searchByUsername:!1,filterByLanguageToLearn:!0,knownLanguage:{id:"all",text:"Cualquier idioma"},languageToLearn:{id:"all",text:"Cualquier idioma"},nearbyUsersIDs:[]}},emailVerified:!1,userInfo:{uid:null,registrationState:null,username:null,email:null,name:null,lastName:null,birthDate:null,gender:null,description:null,knownLanguages:null,languagesToLearn:null,profileImage:null,chatIDs:[],chatUsers:[],chatIDsListener:null,avgRating:null,numRatings:null,location:{}},chats:[],chatsInfo:{activeChat:null},rankingInfo:{lastVisible:null,userIDs:[]},activeUser:[],eventsInfo:{lastVisible:null,events:[]},activeEventID:null,ratings:{},users:[]},getters:{getAppInfoLoaded:function(e){return e.appInfoLoaded},notReadMessagesCountByChatID:function(e){return function(n){var t=e.chats.findIndex((function(e){return e.id==n})),a=0;return null!=t&&e.chats[t].messages.forEach((function(n){n.sender===e.userInfo.uid||n.read||a++})),a}},getProfileHeaderImage:function(e){return e.defaultInfo.profileHeaderImage},getUserIndexByUID:function(e){return function(n){return e.users.findIndex((function(e){return e.uid==n}))}},getUserByUID:function(e,n){return function(t){var a=n.getUserIndexByUID(t);return-1!=a?e.users[a]:null}},getRankingUsers:function(e,n){var t=[];return e.rankingInfo.userIDs.forEach((function(a){var r=n.getUserIndexByUID(a);-1!=r&&t.push(e.users[r])})),t},getSearchUsers:function(e,n){var t=[];return e.searchInfo.userIDs.forEach((function(a){var r=n.getUserIndexByUID(a);-1!=r&&t.push(e.users[r])})),t},getOtherUserInChatByChatID:function(e,n){return function(t){var a=n.getChatWithUserByChatID(t),r=null;return a.users.forEach((function(n){n!=e.userInfo.uid&&(r=n)})),null!=r?n.getUserByUID(r):null}},getEmailVerified:function(e){return e.emailVerified},getRatingOfUserByUID:function(e){return function(n){return e.ratings[n]}},getRegistrationState:function(e){return e.userInfo.registrationState},getChatsInfoActiveChat:function(e){return e.chatsInfo.activeChat},getActiveEvent:function(e){return e.eventsInfo.events.find((function(n){return n.id===e.activeEventID}))},getEvent:function(e){return function(n){return e.eventsInfo.events.find((function(e){return e.id===n}))}},getActiveChatUserID:function(e){return e.activeChat.userID},getChatUserByChatID:function(e){return function(n){return e.userInfo.chatUsers.find((function(e){return e.chatID==n}))}},getNewChatMessageIndex:function(e){return function(n){return e.chats[n].messages.length}},getSearchInfoUsers:function(e){return e.searchInfo.userIDs},getSearchInfoUserByUID:function(e){return function(n){return e.searchInfo.userIDs.find((function(e){return e.uid==n}))}},getChatWithUser:function(e){return e.chatWithUser},getChats:function(e){return e.chats},getSearchInfoFilteringFilterByLanguageToLearn:function(e){return e.searchInfo.filtering.filterByLanguageToLearn},getSearchInfoFiltering:function(e){return e.searchInfo.filtering},getSearchInfoLastVisible:function(e){return e.searchInfo.lastVisible},getSearchInfo:function(e){return e.searchInfo},getLanguageNameByID:function(e){return function(n){return e.allAvailableLanguages[n]}},getChatWithUserByChatID:function(e){return function(n){return e.chats.find((function(e){return e.id==n}))}},getAllAvailableLanguagesAsArray:function(e,n){return Object.keys(e.allAvailableLanguages).map((function(e){var t=n.getLanguageNameByID(e);return new Object({id:e,text:t})}))},getGenderNameByID:function(e){return function(n){return e.allAvailableGenders[n].name}},getAngleInRad:function(){return function(e){return e*Math.PI/180}},getHaversineDistance:function(e,n){return function(e){var t=e.p1,a=e.p2,r=6378137,s=n.getAngleInRad(a.lat-t.lat),o=n.getAngleInRad(a.lng-t.lng),i=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n.getAngleInRad(t.lat))*Math.cos(n.getAngleInRad(a.lat))*Math.sin(o/2)*Math.sin(o/2),c=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),u=r*c;return u}},getGenderImgByID:function(e){return function(n){return e.allAvailableGenders[n].img}},getAllAvailableGendersAsArray:function(e,n){return Object.keys(e.allAvailableGenders).map((function(e){var t=n.getGenderNameByID(e),a=n.getGenderImgByID(e);return new Object({id:e,name:t,img:a})}))},getPathToFlagImageByLanguageID:function(){return function(e){return"img/flags/"+e+".svg"}},getDefaultInfoUserImage:function(e){return e.defaultInfo.userImage},getUserInfo:function(e){return e.userInfo},getUserInfoLocation:function(e){return e.userInfo.location},getUserInfoUID:function(e){return e.userInfo.uid},getUserInfoChatIDs:function(e){return e.userInfo.chatIDs},getMaleDefaultInfoUserImage:function(e){return e.defaultInfo.maleUserImage},getFemaleDefaultInfoUserImage:function(e){return e.defaultInfo.femaleUserImage},getDefaultInfoUserImageByGender:function(e,n){return"M"==e.userInfo.gender?n.getMaleDefaultInfoUserImage:"W"==e.userInfo.gender?n.getFemaleDefaultInfoUserImage:e.defaultInfo.userImage},getUserInfoProfileImage:function(e,n){return e.userInfo.profileImage?e.userInfo.profileImage:n.getDefaultInfoUserImageByGender},getLanguageObjectsByIDs:function(e,n,t){var a=[];return t.forEach((function(e){var t={name:n.getLanguageNameByID(e),img:n.getPathToFlagImageByLanguageID(e)};a.push(t)})),a},getFormattedDateInTextMonth:function(){return function(e){var n=new Date(e);return n.getDate()+" "+l["a"].TEXT_OF+" "+l["a"].MONTHS_OF_THE_YEAR_IN_TEXT[n.getMonth()]+" "+l["a"].TEXT_OF+" "+n.getFullYear()}},getFormattedMonthIn3CapitalLettersText:function(){return function(e){var n=new Date(e),t=l["a"].MONTHS_OF_THE_YEAR_IN_TEXT[n.getMonth()];return t.charAt(0).toUpperCase()+t.charAt(1).toUpperCase()+t.charAt(2).toUpperCase()}},getStoreInitiated:function(e){return e.storeInitiated}},mutations:{setAppInfoLoaded:function(e,n){e.appInfoLoaded=n},setSearchInfoFilteringNearbyUsersIDs:function(e,n){e.searchInfo.filtering.nearbyUsersIDs=n},setEmailVerified:function(e,n){e.emailVerified=n},setUserInfoLocation:function(e,n){e.userInfo.location=n},resetSearchInfoUserIDs:function(e){e.searchInfo.userIDs=[]},resetUserInfo:function(e){e.userInfo={uid:null,registrationState:null,username:null,email:null,name:null,lastName:null,birthDate:null,gender:null,description:null,knownLanguages:null,languagesToLearn:null,profileImage:null,chatIDs:[],chatUsers:[],chatIDsListener:null,avgRating:null,numRatings:null}},setSearchInfoFiltering:function(e,n){return e.searchInfo.filtering=n},resetRankingInfo:function(e){e.rankingInfo={lastVisible:null,userIDs:[]}},resetEventsInfo:function(e){e.eventsInfo={lastVisible:null,events:[]}},resetChatsInfoActiveChat:function(e){e.chatsInfo.activeChat=null},resetChats:function(e){e.chats=[]},resetRatings:function(e){e.ratings={}},setUserRating:function(e,n){n.rating?e.ratings[n.to]=n.rating:delete e.ratings[n.to]},setUserRatingInfo:function(e,n){var t=e.users.findIndex((function(e){return e.uid==n.uid}));e.users[t].avgRating=n.avgRating,e.users[t].numRatings=n.numRatings},setNewUserRatingInfo:function(e,n){var t=e.users.findIndex((function(e){return e.uid==n.to}));if(n.rating)if(e.ratings[n.to]){var a=e.users[t].numRatings,r=e.users[t].avgRating*e.users[t].numRatings,s=(r-e.ratings[n.to]+n.rating)/a;e.users[t].avgRating=s,e.users[t].numRatings=a}else{var o=e.users[t].numRatings+1,i=e.users[t].avgRating*e.users[t].numRatings,c=(i+n.rating)/o;e.users[t].avgRating=c,e.users[t].numRatings=o}else{var u,l=e.users[t].numRatings-1,f=e.users[t].avgRating*e.users[t].numRatings;u=l>0?(f-e.ratings[n.to])/l:0,e.users[t].avgRating=u,e.users[t].numRatings=l}},setUserRatings:function(e,n){e.ratings=n},setUserInfoEmail:function(e,n){e.userInfo.email=n},setUserInfoChatIDs:function(e,n){e.userInfo.chatIDs=n},setUserInfoChatIDsListener:function(e,n){e.userInfo.chatIDsListener=n},addChatToChats:function(e,n){-1==e.chats.findIndex((function(e){return e.id==n.id}))&&e.chats.push(n)},addUserToChatUsers:function(e,n){e.userInfo.chatUsers.find((function(e){return e.chatID==n.chatID}))||e.userInfo.chatUsers.push(n)},addChatIDToChatIDs:function(e,n){e.userInfo.chatIDs.push(n)},addMessageToChat:function(e,n){e.chats[n.chatIndex].messages.push(n.message)},setUserInfoUID:function(e,n){e.userInfo.uid=n},addUserToSearchInfoUserIDs:function(e,n){e.searchInfo.userIDs.push(n)},addRankingInfoUserID:function(e,n){var t=e.rankingInfo.userIDs.findIndex((function(e){return n==e.uid}));1!=t&&e.rankingInfo.userIDs.push(n)},addSearchInfoUserID:function(e,n){var t=e.searchInfo.userIDs.findIndex((function(e){return n==e.uid}));1!=t&&e.searchInfo.userIDs.push(n)},setSearchInfoUserIDs:function(e,n){e.searchInfo.userIDs=n},addEventsInfoEvent:function(e,n){e.eventsInfo.events.push(n)},addUser:function(e,n){var t=e.users.findIndex((function(e){return n.uid==e.uid}));1!=t?e.users.push(n):a["a"].set(e.users,t,n)},setSearchInfoFilteringSearchByUsername:function(e,n){e.searchInfo.filtering.searchByUsername=n},resetSearchInfo:function(e){e.searchInfo={lastVisible:null,userIDs:[],filtering:{genderW:!0,genderM:!0,ageRange:[l["a"].MIN_USER_AGE,l["a"].MAX_USER_AGE],maxDistance:3,maxDistanceRanges:[1e3,5e3,1e4,null],maxDistanceRangesText:[l["a"].TEXT_1_KM,l["a"].TEXT_5_KM,l["a"].TEXT_10_KM,"∞"],searchByUsername:!1,filterByLanguageToLearn:!0,knownLanguage:{id:"all",text:"Cualquier idioma"},languageToLearn:{id:"all",text:"Cualquier idioma"},nearbyUsersIDs:[]}}},resetSearchInfoFiltering:function(e){e.searchInfo.filtering={genderW:!0,genderM:!0,ageRange:[l["a"].MIN_USER_AGE,l["a"].MAX_USER_AGE],maxDistance:3,maxDistanceRanges:[1e3,5e3,1e4,null],maxDistanceRangesText:[l["a"].TEXT_1_KM,l["a"].TEXT_5_KM,l["a"].TEXT_10_KM,"∞"],searchByUsername:!1,filterByLanguageToLearn:!0,knownLanguage:{id:"all",text:"Cualquier idioma"},languageToLearn:{id:"all",text:"Cualquier idioma"},nearbyUsersIDs:[]}},setSearchInfoLastVisible:function(e,n){e.searchInfo.lastVisible=n},setRankingInfoLastVisible:function(e,n){e.rankingInfo.lastVisible=n},setEventsInfoLastVisible:function(e,n){e.eventsInfo.lastVisible=n},setSearchInfoFilter:function(e,n){e.searchInfo.filter=n},setUserInfoUsername:function(e,n){e.userInfo.username=n},setUserInfoName:function(e,n){e.userInfo.name=n},setUserInfoLastName:function(e,n){e.userInfo.lastName=n},setUserInfoBirthDate:function(e,n){e.userInfo.birthDate=n},setUserInfoGender:function(e,n){e.userInfo.gender=n},setUserInfoAvgRating:function(e,n){e.userInfo.avgRating=n},setUserInfoNumRatings:function(e,n){e.userInfo.numRatings=n},setSearchedUserAvgRating:function(e,n){var t=e.searchInfo.userIDs.findIndex((function(e){return e.uid==n.uid}));e.searchInfo.userIDs[t].avgRating=n.avgRating},setSearchedUserNumRatings:function(e,n){var t=e.searchInfo.userIDs.findIndex((function(e){return e.uid==n.uid}));e.searchInfo.userIDs[t].numRatings=n.numRatings},setUserInfoDescription:function(e,n){e.userInfo.description=n},setUserInfoProfileImage:function(e,n){e.userInfo.profileImage=n},setUserInfoKnownLanguages:function(e,n){e.userInfo.knownLanguages=n},setUserInfoLanguagesToLearn:function(e,n){e.userInfo.languagesToLearn=n},setRegistrationState:function(e,n){e.userInfo.registrationState=n},setChatWithUser:function(e,n){e.chatWithUser=n},setChatsInfoActiveChat:function(e,n){e.chatsInfo.activeChat=n},setActiveEventID:function(e,n){e.activeEventID=n},setMessageToRead:function(e,n){var t=e.chats.findIndex((function(e){return e.id==n.chatID}));if(-1!=t){var a=e.chats[t].messages.findIndex((function(e){return e.id=n.messageID}));e.chats[t].messages[a].read=!0}},closeAllChatListenersFirebase:function(e){e.chats.forEach((function(e){e.databaseListener()}))},addNewMessage:function(e,n){var t=e.chats.findIndex((function(e){return e.id==n.chatID})),r=e.chats[t].messages.findIndex((function(e){return e.id==n.message.id}));if(-1==r)if(null==n.message.created)e.chats[t].messages.splice(e.chats[t].messages.length,0,n.message);else{var s=e.chats[t].messages.findIndex((function(e){return e.created.toDate().getTime()>n.message.created.toDate().getTime()}));-1==s?e.chats[t].messages.push(n.message):e.chats[t].messages.splice(s,0,n.message)}else a["a"].set(e.chats[t].messages,r,n.message)},resetChat:function(e){e.chats=[],e.chatWithUser=null}},actions:{isUsernameInUseFirebase:function(e,n){return new Promise((function(e,t){var a=c["firestore"]();a.collection("UsersPublicInfo").where("username","==",n).get().then((function(n){n.size>0?c["auth"]().currentUser.uid==n.docs[0].id?e(!1):e(!0):e(!1)})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},setUserPersistanceFirebase:function(e){return new Promise((function(n,t){c["auth"]().setPersistence(c["auth"].Auth.Persistence.LOCAL).then((function(){e.commit("setUserInfoUID",c["auth"]().currentUser.uid),n()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},registerUserFirebase:function(e,n){return new Promise((function(t,a){e.state.userInfo.registrationState?e.dispatch("setUserPersistanceFirebase").then((function(){e.dispatch("setUserUsernameFirebase",n.username).then((function(){t()})).catch((function(e){a(e)}))})).catch((function(e){a(e)})):c["auth"]().createUserWithEmailAndPassword(n.email,n.password).then((function(){console.log("Success registering user in system."),e.dispatch("setUserPersistanceFirebase").then((function(){e.dispatch("setUserPrivateInfoFirebase",n).then((function(){t()})).catch((function(e){a(e)}))})).catch((function(n){e.dispatch("logoutUserFirebase").then((function(){a(n)})).catch((function(){a(n)}))}))})).catch((function(e){console.log(e),"auth/email-already-in-use"==e.code?a(l["a"].ERROR_ALREADY_AN_ACCOUNT_WITH_THIS_EMAIL):a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},logoutUserFirebase:function(e){return new Promise((function(n,t){null!=c["auth"]()&&(e.commit("closeAllChatListenersFirebase"),c["auth"]().signOut().then((function(){console.log("User logged out correctly!"),e.commit("resetChat"),n()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)})))}))},setUserPrivateInfoFirebase:function(e,n){return new Promise((function(t,a){var r=c["firestore"]();r.collection("UsersPrivateInfo").doc(c["auth"]().currentUser.uid).set({email:n.email,name:n.name,lastName:n.lastName,registrationState:"registered"},{merge:!0}).then((function(){console.log("Private info successfully written"),e.commit("setRegistrationState","registered"),e.commit("setUserInfoEmail",n.email),e.commit("setUserInfoName",n.name),e.commit("setUserInfoLastName",n.lastName),t()})).catch((function(e){console.error("Error writing private info: ",e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},setUserPrivateInfoRegistrationStateFirebase:function(e,n){return new Promise((function(t,a){var r=c["firestore"]();r.collection("UsersPrivateInfo").doc(c["auth"]().currentUser.uid).set({registrationState:n},{merge:!0}).then((function(){console.log("Registration state successfully written"),e.commit("setRegistrationState",n),t()})).catch((function(e){console.error("Error writing registration state info: ",e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},sendEmailVerificationFirebase:function(){return new Promise((function(e,n){c["auth"]().currentUser.sendEmailVerification().then((function(){console.log("verification sent: "),e()}),(function(e){console.log("verification not sent: "+e.message),n(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},checkEmailVerifiedFirebase:function(e){return new Promise((function(n,t){c["auth"]().currentUser.reload().then((function(){c["auth"]().currentUser.emailVerified&&(console.log("Email is verified"),e.dispatch("setUserPrivateInfoRegistrationStateFirebase","emailVerified").then((function(){n(!0)})).catch((function(e){t(e)})))})).catch((function(e){console.error(e),t(e)}))}))},setUserProfileInfoFirebase:function(e,n){return new Promise((function(t,a){var r=c["firestore"]();r.collection("UsersPublicInfo").doc(c["auth"]().currentUser.uid).set({username:n.username.toLowerCase(),birthDate:new Date(n.birthDate),gender:n.gender,description:n.description,avgRating:0,numRatings:0},{merge:!0}).then((function(){console.log("Profile info successfully written in users"),e.dispatch("setUserPrivateInfoRegistrationStateFirebase","profileInfoFilled").then((function(){e.commit("setUserInfoUsername",n.username),e.commit("setUserInfoBirthDate",n.birthDate),e.commit("setUserInfoGender",n.gender),e.commit("setUserInfoDescription",n.description),t()})).catch((function(e){a(e)})),t()})).catch((function(e){console.error("Error writing profile info in users: ",e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},setUserLanguagesFirebase:function(e,n){return new Promise((function(t,a){var r=c["firestore"](),s=[],o=[];console.log(n);for(var i=0;i<n.knownLanguages.length;i++)s.push(n.knownLanguages[i].id);for(var u=0;u<n.languagesToLearn.length;u++)o.push(n.languagesToLearn[u].id);r.collection("UsersPublicInfo").doc(c["auth"]().currentUser.uid).set({knownLanguages:s,languagesToLearn:o},{merge:!0}).then((function(){console.log("Languages info successfully written in users"),e.dispatch("setUserPrivateInfoRegistrationStateFirebase","languagesFilled").then((function(){e.commit("setUserInfoKnownLanguages",s),e.commit("setUserInfoLanguagesToLearn",o),t()})).catch((function(e){a(e)}))})).catch((function(e){console.error("Error writing languages info in users: ",e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},setUserProfileImageDatabase:function(e,n){return new Promise((function(t,r){a["a"].nextTick((function(){var a=c["firestore"](),s=c["auth"]().currentUser.uid,o=c["storage"]().ref().child("UserProfileImages/"+s);o.putString(n,"base64").then((function(){console.log("User profile image uploaded"),o.getDownloadURL().then((function(n){a.collection("UsersPublicInfo").doc(s).set({profileImage:n},{merge:!0}).then((function(){console.log("User profile image url successfully written"),e.dispatch("setUserPrivateInfoRegistrationStateFirebase","registered").then((function(){e.commit("setUserInfoProfileImage",n),t()})).catch((function(e){r(e)}))})).catch((function(n){console.error("Error writing user profile image url info in users: ",n),e.dispatch("deleteUserProfileImageDatabase",s),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))})).catch((function(){r(l["a"].ERROR_UPLOADING_IMAGE)}))}))}))},deleteUserProfileImageDatabase:function(e,n){return new Promise((function(t,a){var r=c["storage"]().ref().child("UserProfileImages/"+n);r.delete().then((function(){console.log("User profile image removed from database storage"),e.commit("setUserInfoProfileImage",null),t()})).catch((function(e){console.error(e),a(l["a"].ERROR_SOMETHING_HAPPENED)}))}))},loginUserFirebase:function(e,n){return new Promise((function(t,a){c["auth"]().signInWithEmailAndPassword(n.email,n.password).then((function(n){console.log("Success logging user in system."),e.dispatch("setUserPersistanceFirebase").then((function(){e.dispatch("getUserPrivateInfo").then((function(){console.log("Success UserPrivateInfo retrieved."),e.dispatch("getUserPublicInfo").then((function(){console.log("Success UserPublicInfo retrieved."),e.dispatch("getRatingsInRatingsFirebase").then((function(){t(n)})).catch((function(e){console.error(e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))})).catch((function(e){a(e)}))})).catch((function(e){a(e)}))})).catch((function(n){e.dispatch("logoutUserFirebase").then((function(){a(n)})).catch((function(){a(n)}))}))})).catch((function(e){console.log(e),"auth/wrong-password"==e.code?a(l["a"].ERROR_WRONG_EMAIL_PASSWORD_COMBINATION):a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},getAppInfoForLoggedUserFirebase:function(e){return e.commit("resetUserInfo"),e.commit("resetChatsInfoActiveChat"),e.commit("resetChats"),e.commit("resetRatings"),e.commit("setUserInfoUID",c["auth"]().currentUser.uid),new Promise((function(n,t){e.dispatch("getUserPrivateInfo").then((function(){console.log("Success UserPrivateInfo retrieved."),e.dispatch("getUserPublicInfo").then((function(){console.log("Success UserPublicInfo retrieved."),e.dispatch("getRatingsInRatingsFirebase").then((function(){e.dispatch("getUserLocation").then((function(){n()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)})),n()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))}))},getUserPrivateInfo:function(e){return new Promise((function(n,t){var a=c["firestore"](),r=c["auth"]().currentUser.uid;a.collection("UsersPrivateInfo").doc(r).get().then((function(a){a.exists?(e.commit("setRegistrationState",a.data().registrationState),e.commit("setUserInfoEmail",a.data().email),e.commit("setUserInfoName",a.data().name),e.commit("setUserInfoLastName",a.data().lastName),n()):(console.warn("No such document!"),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM))})).catch((function(e){console.warn("Error getting document:",e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},getUserPublicInfoDocByUIDFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(e,a){t.collection("UsersPublicInfo").doc(n).get().then((function(n){e(n)})).catch((function(e){console.warn("Error getting document:",e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},getUserPublicInfo:function(e){return new Promise((function(n,t){var a=c["auth"]().currentUser.uid;e.dispatch("getUserPublicInfoDocByUIDFirebase",a).then((function(a){a.exists?(e.commit("setUserInfoUsername",a.data().username),e.commit("setUserInfoBirthDate",a.data().birthDate),e.commit("setUserInfoGender",a.data().gender),e.commit("setUserInfoDescription",a.data().description),e.commit("setUserInfoKnownLanguages",a.data().knownLanguages),e.commit("setUserInfoLanguagesToLearn",a.data().languagesToLearn),e.commit("setUserInfoProfileImage",a.data().profileImage),e.commit("setUserInfoAvgRating",a.data().avgRating),e.commit("setUserInfoNumRatings",a.data().numRatings),e.dispatch("createChatIDsListenerFirebase").then((function(){var r=a.data().chats;try{var s=[];r.forEach((function(n){s.push(e.dispatch("createChatListenerFirebase",n))})),Promise.all(s).then((function(){n()})).catch((function(e){t(e)}))}catch(o){console.error(o),t(o)}})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))):(console.warn("No such document!"),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM))})).catch((function(e){console.warn("Error getting document:",e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},createChatIDsListenerFirebase:function(e){var n=c["firestore"]();return new Promise((function(t,a){try{var r=n.collection("UsersPublicInfo").doc(c["auth"]().currentUser.uid).onSnapshot((function(n){n&&(e.commit("setUserInfoChatIDs",n.data().chats),e.commit("setUserInfoChatIDsListener",r)),t()}))}catch(s){console.error(s),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}}))},setChatWithUserMessagesToRead:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){var s=e.state.chats.findIndex((function(e){return e.id==n})),o=[];e.state.chats[s].messages.forEach((function(a){a.read||a.sender==e.state.userInfo.uid||o.push(t.collection("Chats").doc(n).collection("Messages").doc(a.id).update({read:!0}).then((function(){console.log("Message successfully updated read state ")})).catch((function(e){console.error("Error updating message read state: ",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)})))})),Promise.all(o).then((function(){a()})).catch((function(){console.error("Error updating messages read state: "),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},sendChatMessageFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){var s=e.state.chats.findIndex((function(e){return e.id==n.chatID})),o=e.state.chats[s].messages.length,i={created:c["firestore"].FieldValue.serverTimestamp(),text:n.messageText,read:!1,sender:e.state.userInfo.uid},u=[];if(0==o){var f,g=e.state.userInfo.uid,h=e.getters.getOtherUserInChatByChatID(n.chatID);f=g<h?g+h:h+g,u.push(t.collection("UsersPublicInfo").doc(g).update({chats:c["firestore"].FieldValue.arrayUnion(f)}).then((function(){e.commit("addChatIDToChatIDs",f),console.log("chatID successfuly written p1")})).catch((function(e){console.error("Error writing chatID",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))),u.push(t.collection("UsersPublicInfo").doc(h).update({chats:c["firestore"].FieldValue.arrayUnion(f)}).then((function(){console.log("chatID successfuly written p2")})).catch((function(e){console.error("Error writing chatID",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)})))}Promise.all(u).then((function(){t.collection("Chats").doc(n.chatID).collection("Messages").doc().set(i).then((function(){console.log("Message successfully added"),a()})).catch((function(e){console.error("Error adding message",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))})).catch((function(e){console.error("Error writing chatID on users chatIDs: "+e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},listUsersSearchedPageFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){n.first&&(e.commit("setSearchInfoUserIDs",[]),e.commit("setSearchInfoLastVisible",null));var s=t.collection("UsersPublicInfo");e.state.searchInfo.filtering.genderM&&!e.state.searchInfo.filtering.genderW?s=s.where(l["a"].DATABASE_GENDER_FIELD,"==","M"):e.state.searchInfo.filtering.genderW&&!e.state.searchInfo.filtering.genderM?s=s.where(l["a"].DATABASE_GENDER_FIELD,"==","W"):e.state.searchInfo.filtering.genderW||e.state.searchInfo.filtering.genderM||(e.commit("setSearchInfoUserIDs",[]),e.commit("setSearchInfoLastVisible",null));var o=new Date;o.setFullYear(o.getFullYear()-e.state.searchInfo.filtering.ageRange[0]),o.setHours(0,0,0),s=s.where(l["a"].DATABASE_BIRTHDATE_FIELD,"<",o),o=new Date,o.setFullYear(o.getFullYear()-e.state.searchInfo.filtering.ageRange[1]-1),o.setHours(0,0,0),s=s.where(l["a"].DATABASE_BIRTHDATE_FIELD,">",o),e.state.searchInfo.filtering.filterByLanguageToLearn&&"all"!=e.state.searchInfo.filtering.languageToLearn.id?s=s.where(l["a"].DATABASE_LANGUAGES_TO_LEARN_FIELD,"array-contains",e.state.searchInfo.filtering.languageToLearn.id):e.state.searchInfo.filtering.filterByLanguageToLearn||"all"==e.state.searchInfo.filtering.knownLanguage.id||(s=s.where(l["a"].DATABASE_KNOWN_LANGUAGES_FIELD,"array-contains",e.state.searchInfo.filtering.knownLanguage.id));var i=s.orderBy(n.orderBy).startAfter(e.state.searchInfo.lastVisible).limit(l["a"].SEARCHED_USERS_PAGE_SIZE);i.get().then((function(t){var o=t.docs.findIndex((function(n){return n.id==e.state.userInfo.uid})),i=t.docs;if(-1!=o){i.splice(o,1);var c=t.docs[t.docs.length-1];e.commit("setSearchInfoLastVisible",c);var u=s.orderBy(n.orderBy).startAfter(e.state.searchInfo.lastVisible).limit(1);u.get().then((function(n){i.push(n.docs[0]),e.dispatch("setSearchedUsersState",{newDocs:i,originalDocs:n.docs}).then((function(){a()}))})).catch((function(e){console.warn("Error fetching page: ",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}else e.dispatch("setSearchedUsersState",{newDocs:i,originalDocs:t.docs}).then((function(){a()}))})).catch((function(e){console.warn("Error fetching page: ",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},setSearchedUsersState:function(e,n){return new Promise((function(t){var a=n.newDocs.map((function(e){var n=e.id,t=e.data();return ne({uid:n},t)}));if(a.forEach((function(n){e.commit("addUser",n),e.commit("addSearchInfoUserID",n.uid)})),n.originalDocs.length>0){var r=n.originalDocs[n.originalDocs.length-1];e.commit("setSearchInfoLastVisible",r)}else e.commit("setSearchInfoUserIDs",[]),e.commit("setSearchInfoLastVisible",null);t()}))},isNextUsersSearchedPageEmptyFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){var s=t.collection("UsersPublicInfo");e.state.searchInfo.filtering.genderM&&!e.state.searchInfo.filtering.genderW?s=s.where(l["a"].DATABASE_GENDER_FIELD,"==","M"):e.state.searchInfo.filtering.genderW&&!e.state.searchInfo.filtering.genderM?s=s.where(l["a"].DATABASE_GENDER_FIELD,"==","W"):e.state.searchInfo.filtering.genderW||e.state.searchInfo.filtering.genderM||(e.commit("setSearchInfoUserIDs",[]),e.commit("setSearchInfoLastVisible",null),a(!0));var o=new Date;o.setFullYear(o.getFullYear()-e.state.searchInfo.filtering.ageRange[0]),o.setHours(0,0,0),s=s.where(l["a"].DATABASE_BIRTHDATE_FIELD,"<",o),o=new Date,o.setFullYear(o.getFullYear()-e.state.searchInfo.filtering.ageRange[1]-1),o.setHours(0,0,0),s=s.where(l["a"].DATABASE_BIRTHDATE_FIELD,">",o),e.state.searchInfo.filtering.filterByLanguageToLearn&&"all"!=e.state.searchInfo.filtering.languageToLearn.id?s=s.where(l["a"].DATABASE_LANGUAGES_TO_LEARN_FIELD,"array-contains",e.state.searchInfo.filtering.languageToLearn.id):e.state.searchInfo.filtering.filterByLanguageToLearn||"all"==e.state.searchInfo.filtering.knownLanguage.id||(s=s.where(l["a"].DATABASE_KNOWN_LANGUAGES_FIELD,"array-contains",e.state.searchInfo.filtering.knownLanguage.id),console.log(e.state.searchInfo.filtering.knownLanguage.id)),s.orderBy(n.orderBy).startAfter(e.state.searchInfo.lastVisible).limit(l["a"].SEARCHED_USERS_PAGE_SIZE).get().then((function(n){var t=n.docs.findIndex((function(n){return n.id==e.state.userInfo.uid})),r=n.docs;-1!=t&&r.splice(t,1),a(0==r.length)})).catch((function(e){console.log(e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},searchUsersByUsernameFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){e.commit("resetSearchInfo"),e.commit("setSearchInfoFilteringSearchByUsername",!0);var s=t.collection("UsersPublicInfo").orderBy(n.orderBy).startAt(n.searchByUsernameField).endAt(n.searchByUsernameField+"");s.get().then((function(n){var t=n.docs.findIndex((function(n){return n.id==e.state.userInfo.uid}));1!=t&&n.docs.splice(t,1);var r=n.docs.map((function(e){var n=e.id,t=e.data();return ne({uid:n},t)})),s=[];if(r.forEach((function(n){e.commit("addUser",n),s.push(n.uid)})),e.commit("setSearchInfoUserIDs",s),n.docs.length>0){var o=n.docs[n.docs.length-1];e.commit("setSearchInfoLastVisible",o)}a()})).catch((function(e){console.warn("Error fetching users: ",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},prepareChatWithUser:function(e,n){return new Promise((function(t,a){e.dispatch("createChatFirebase",{chatID:n.chatID,userID:n.userID}).then((function(){e.commit("setChatsInfoActiveChat",n.chatID),t()})).catch((function(e){console.error(e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},createChatFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){var s={messages:[],users:[e.state.userInfo.uid,n.userID]};t.collection("Chats").doc(n.chatID).set(s).then((function(){console.log("Chats info successfully written in Chats"),e.dispatch("createChatListenerFirebase",n.chatID).then((function(){a()})).catch((function(e){r(e)}))})).catch((function(e){console.error("Error writing profile info in users: ",e),r(e)}))}))},createChatListenerFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){try{var s=t.collection("Chats").doc(n).onSnapshot((function(o){if(o&&o.data()){e.commit("addChatToChats",ne({id:o.id},o.data(),{databaseListener:s,messages:[]}));try{t.collection("Chats").doc(n).collection("Messages").onSnapshot((function(n){if(n&&n.docs){var t=n.docs.map((function(e){var n=e.id,t=e.data();return ne({id:n},t)}));t.forEach((function(n){var t={chatID:o.id,message:n};e.commit("addNewMessage",t),e.state.chatsInfo.activeChat==t.chatID&&e.dispatch("setChatWithUserMessagesToRead",e.state.chatsInfo.activeChat).catch((function(e){console.warn("Error updating messages to read:",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))}}))}catch(u){console.error(u),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}var i=o.data().users.find((function(e){return e!=c["auth"]().currentUser.uid}));e.dispatch("getUserPublicInfoDocByUIDFirebase",i).then((function(t){if(t.exists){var a={id:i,chatID:n,username:t.data().username,birthDate:t.data().birthDate,gender:t.data().gender,description:t.data().description,knownLanguages:t.data().knownLanguages,languagesToLearn:t.data().languagesToLearn,profileImage:t.data().profileImage};e.commit("addUserToChatUsers",a)}})).catch((function(e){console.warn("Error getting document:",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}a()}))}catch(o){console.error(o),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}}))},rateUser:function(e,n){return new Promise((function(t,a){e.dispatch("getRatingInUsersPublicInfo",n.to).then((function(r){e.commit("setUserRatingInfo",r),e.dispatch("setRatingInRatingsFirebase",n).then((function(){e.commit("setNewUserRatingInfo",n),e.commit("setUserRating",n),t()})).catch((function(e){console.error(e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))})).catch((function(e){console.error(e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},setRatingInRatingsFirebase:function(e,n){return new Promise((function(e,t){var a=c["firestore"](),r={};r[n.to]=n.rating,n.rating?a.collection("Ratings").doc(n.from).set(r,{merge:!0}).then((function(){console.log("Rating successfully written in Ratings"),e()})).catch((function(e){console.error("Error writing rating info in Ratings: ",e),t(e)})):a.collection("Ratings").doc(n.from).update(Object(o["a"])({},n.to,c["firestore"].FieldValue.delete())).then((function(){console.log("Rating successfully deleted of Ratings"),e()})).catch((function(e){console.error("Error deleting rating info of Ratings: ",e),t(e)}))}))},getRatingsInRatingsFirebase:function(e){var n=c["firestore"]();return new Promise((function(t,a){n.collection("Ratings").doc(e.state.userInfo.uid).get().then((function(n){n.exists&&e.commit("setUserRatings",n.data()),t()})).catch((function(e){console.warn("Error getting document:",e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},getRatingInUsersPublicInfo:function(e,n){var t=c["firestore"]();return new Promise((function(e,a){t.collection("UsersPublicInfo").doc(n).get().then((function(t){console.log(t.data()),console.log(n);var a={uid:n,avgRating:t.data().avgRating,numRatings:t.data().numRatings};e(a)})).catch((function(e){console.warn("Error getting document:",e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},listUsersRankingPageFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){var s;n&&e.commit("resetRankingInfo"),s=null==e.state.rankingInfo.lastVisible?t.collection("UsersPublicInfo").orderBy(l["a"].DATABASE_AVG_RATING_FIELD,"desc").orderBy(l["a"].DATABASE_NUM_RATINGS_FIELD,"desc"):t.collection("UsersPublicInfo").orderBy(l["a"].DATABASE_AVG_RATING_FIELD,"desc").orderBy(l["a"].DATABASE_NUM_RATINGS_FIELD,"desc").startAfter(e.state.rankingInfo.lastVisible),s.limit(l["a"].RANKING_PAGE_SIZE).get().then((function(n){console.log(n);var t=n.docs.map((function(e){var n=e.id,t=e.data();return ne({uid:n},t)}));if(t.forEach((function(n){e.commit("addUser",n),e.commit("addRankingInfoUserID",n.uid)})),n.docs.length>0){var r=n.docs[n.docs.length-1];e.commit("setRankingInfoLastVisible",r)}a()})).catch((function(e){console.warn("Error fetching page: ",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},isNextRankingUsersPageEmptyFirebase:function(e){var n=c["firestore"]();return new Promise((function(t,a){var r=n.collection("UsersPublicInfo").orderBy(l["a"].DATABASE_AVG_RATING_FIELD,"desc").orderBy(l["a"].DATABASE_NUM_RATINGS_FIELD,"desc").startAfter(e.state.rankingInfo.lastVisible).limit(l["a"].RANKING_PAGE_SIZE);r.get().then((function(e){console.log(e.docs.length),t(0==e.docs.length)})).catch((function(e){console.log(e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},getUserLocation:function(e){return new Promise((function(n,t){e.dispatch("geolocateUser").then((function(a){e.commit("setUserInfoLocation",a),e.dispatch("updateUserLocationFirebase",a).then((function(){n()})).catch((function(e){console.error(e),t(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))})).catch((function(){e.dispatch("getUserLocationFirebase",e.state.userInfo.uid).then((function(n){e.commit("setUserInfoLocation",n),t(l["a"].TEXT_PROBLEM_GETTING_CURRENT_LOCATION)})).catch((function(){e.commit("setUserInfoLocation",null),t(l["a"].TEXT_PROBLEM_GETTING_CURRENT_LOCATION)}))}))}))},getUserLocationFirebase:function(e,n){var t=new L["GeoFirestore"](c["firestore"]());return new Promise((function(e,a){t.collection("UsersLocation").doc(n).get().then((function(n){var t=n.data();console.log(JSON.stringify(t)),t?e({lat:t.coordinates._lat,lng:t.coordinates._long}):a()})).catch((function(e){console.log(e),a()}))}))},updateUserLocationFirebase:function(e,n){var t=new L["GeoFirestore"](c["firestore"]());return new Promise((function(a,r){t.collection("UsersLocation").doc(e.state.userInfo.uid).set({coordinates:new c["firestore"].GeoPoint(n.lat,n.lng)}).then((function(){a()})).catch((function(e){console.log(e),r()}))}))},geolocateUser:function(){return new Promise((function(e,n){try{navigator.geolocation.getCurrentPosition((function(n){e({lat:n.coords.latitude,lng:n.coords.longitude})}),(function(e){console.log(e),n()}))}catch(t){console.log(t),n()}}))},getNearbyUsersFirebase:function(e,n){var t=new L["GeoFirestore"](c["firestore"]()),a=t.collection("UsersLocation").near({center:new c["firestore"].GeoPoint(e.state.userInfo.location.lat,e.state.userInfo.location.lng),radius:n});return new Promise((function(e,n){a.get().then((function(n){e(n.docs)})).catch((function(e){console.log(e),n(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},listNearbyUsersSearchedPageFirebase:function(e,n){var t=c["firestore"](),a=0,r=0,s=[];return new Promise((function(o,i){if(n.first)e.commit("setSearchInfoUserIDs",[]),e.commit("setSearchInfoLastVisible",null),e.dispatch("getNearbyUsersFirebase",e.state.searchInfo.filtering.maxDistanceRanges[e.state.searchInfo.filtering.maxDistance]).then((function(n){var c=[];n.forEach((function(n){n.id!=e.state.userInfo.uid&&c.push(n.id)})),e.commit("setSearchInfoUserIDs",c);while(a<l["a"].SEARCHED_USERS_PAGE_SIZE&&r<e.state.searchInfo.filtering.nearbyUsersIDs.length)console.log(e.state.searchInfo.filtering.nearbyUsersIDs[r]),s.push(t.collection("UsersPublicInfo").doc(e.state.searchInfo.filtering.nearbyUsersIDs[r]).get().then((function(n){console.log(n),e.commit("addUserToSearchInfoUserIDs",n.id)})).catch((function(n){console.log(n),e.commit("setSearchInfoLastVisible",r-1),i(l["a"].TEXT_PROBLEM_GETTING_NEARBY_USERS)}))),a++,r++;Promise.all(s).then((function(){e.commit("setSearchInfoLastVisible",r-1),o()})).catch((function(n){e.commit("setSearchInfoLastVisible",r-1),i(n)}))})).catch((function(e){console.log(e),i(l["a"].TEXT_PROBLEM_GETTING_NEARBY_USERS)}));else{r=e.state.searchInfo.lastVisible+1;while(a<l["a"].SEARCHED_USERS_PAGE_SIZE&&r<e.state.searchInfo.filtering.nearbyUsersIDs.length)console.log(e.state.searchInfo.filtering.nearbyUsersIDs[r]),s.push(t.collection("UsersPublicInfo").doc(e.state.searchInfo.filtering.nearbyUsersIDs[r]).get().then((function(n){console.log(n),e.commit("addUserToSearchInfoUserIDs",n.id)})).catch((function(n){console.log(n),e.commit("setSearchInfoLastVisible",r-1),i(l["a"].TEXT_PROBLEM_GETTING_NEARBY_USERS)}))),a++,r++;Promise.all(s).then((function(){e.commit("setSearchInfoLastVisible",r-1),o()})).catch((function(n){e.commit("setSearchInfoLastVisible",r-1),i(n)}))}}))},isNextNearbyUsersSearchedPageEmptyFirebase:function(e){var n=c["firestore"]();return new Promise((function(t,a){console.log("--"+e.state.searchInfo.lastVisible),console.log("--"+e.state.searchInfo.filtering.nearbyUsersIDs.length),e.state.searchInfo.lastVisible>=e.state.searchInfo.filtering.nearbyUsersIDs.length-1&&t(!0);var r=e.state.searchInfo.lastVisible+1;while(r<e.state.searchInfo.filtering.nearbyUsersIDs.length-1)n.collection("UsersPublicInfo").doc(e.state.searchInfo.filtering.nearbyUsersIDs[r]).get().then((function(n){e.commit("addUserToSearchInfoUserIDs",ne({uid:n.id},n.data())),console.log("!!"+e.state.searchInfo.lastVisible),t(!1)})).catch((function(n){console.log(n),e.commit("setSearchInfoLastVisible",r-1),a(!0)})),r++}))},listEventsEventsPageFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){var s;n&&e.commit("resetEventsInfo");var o=new Date;s=null==e.state.eventsInfo.lastVisible?t.collection(l["a"].DATABASE_COLLECTION_EVENTS).where(l["a"].DATABASE_DATE_FIELD,">",o).orderBy(l["a"].DATABASE_DATE_FIELD):t.collection(l["a"].DATABASE_COLLECTION_EVENTS).where(l["a"].DATABASE_DATE_FIELD,">",o).orderBy(l["a"].DATABASE_DATE_FIELD).startAfter(e.state.eventsInfo.lastVisible),s.limit(l["a"].EVENTS_PAGE_SIZE).get().then((function(n){var t=n.docs.map((function(e){var n=e.id,t=e.data();return ne({id:n},t)}));if(t.forEach((function(n){console.log(n);var t={lat:n.coordinates.latitude,lng:n.coordinates.longitude};if(console.log(t),console.log(e.state.userInfo.location),null!=e.state.userInfo.location){var a=e.getters.getHaversineDistance({p1:t,p2:e.state.userInfo.location})/1e3;n=ne({},n,{distance:parseFloat(a).toFixed(1)})}else n=ne({},n,{distance:null});e.commit("addEventsInfoEvent",n)})),n.docs.length>0){var r=n.docs[n.docs.length-1];e.commit("setEventsInfoLastVisible",r)}a()})).catch((function(e){console.warn("Error fetching page: ",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},isNextEventsEventsPageEmptyFirebase:function(e){var n=c["firestore"]();return new Promise((function(t,a){var r=new Date,s=n.collection(l["a"].DATABASE_COLLECTION_EVENTS).where(l["a"].DATABASE_DATE_FIELD,">",r).orderBy(l["a"].DATABASE_DATE_FIELD).startAfter(e.state.eventsInfo.lastVisible).limit(l["a"].EVENTS_PAGE_SIZE);s.get().then((function(e){t(0==e.docs.length)})).catch((function(e){console.log(e),a(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},setSearchInfoFiltering:function(e,n){return e.commit("setEventsInfoLastVisible",n)},getUserByUID:function(e,n){return new Promise((function(t,a){var r=e.getters.getUserByUID(n);console.log(r),null!=r?t(r):e.dispatch("getUserPublicInfoDocByUIDFirebase",n).then((function(s){s.data()?(r=ne({uid:n},s.data()),e.commit("addUser",r),t(r)):a()})).catch((function(e){console.log(e),a()}))}))},getEventFirebase:function(e,n){var t=c["firestore"]();return new Promise((function(a,r){t.collection(l["a"].DATABASE_COLLECTION_EVENTS).doc(n).get().then((function(n){var t={lat:n.data().coordinates.latitude,lng:n.data().coordinates.longitude},r=e.getters.getHaversineDistance({p1:t,p2:e.state.userInfo.location})/1e3,s=ne({id:n.id},n.data(),{distance:parseFloat(r).toFixed(1)});a(s)})).catch((function(e){console.warn("Error fetching event: ",e),r(l["a"].ERROR_GENERIC_CONNECTION_PROBLEM)}))}))},getLoggedUser:function(e){return new Promise((function(n,t){e.dispatch("database/isUserAuth").then((function(e){n(e)})).catch((function(e){console.error(e),t(e)}))}))},resetAppState:function(e){return new Promise((function(n,t){if(e.getters.getAppInfoLoaded){var a=[];a.push(e.dispatch("user/resetState")),a.push(e.dispatch("users/resetState")),a.push(e.dispatch("chats/resetState")),a.push(e.dispatch("events/resetState")),a.push(e.dispatch("ranking/resetState")),a.push(e.dispatch("permissions/resetState")),Promise.all(a).then((function(){console.log("state successfully reseted."),e.commit("setAppInfoLoaded",!1),n()})).catch((function(e){console.error(e),console.log("Error resetting state."),t(l["a"].ERROR_GENERIC_PROBLEM)}))}else n()}))},initAppInfo:function(e){return new Promise((function(n,t){e.dispatch("user/isUserLogged").then((function(a){a&&!e.getters.getAppInfoLoaded?e.dispatch("user/initState").then((function(){console.log("user module state successfully initiated."),e.dispatch("chats/initState").then((function(){console.log("chats module state successfully initiated."),e.dispatch("ranking/initState").then((function(){console.log("ranking module state successfully initiated."),e.dispatch("events/initState").then((function(){console.log("events module state successfully initiated."),e.commit("setAppInfoLoaded",!0),n()})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))})).catch((function(e){t(e)}))})).catch((function(e){t(e)})):n()})).catch((function(e){console.log("Error initiating users module state."),t(e)}))}))}}});a["a"].use(T["a"]);var ae=new T["a"]({base:"/",routes:[{path:"*",redirect:"/home"},{path:"/",redirect:"/home"},{path:"/home",name:"home",component:S},{path:"/login",name:"login",component:function(){return Promise.all([t.e("chunk-622f8ab8"),t.e("chunk-3dc88c82")]).then(t.bind(null,"e977"))}},{path:"/sign-up",name:"signUp",component:function(){return Promise.all([t.e("chunk-622f8ab8"),t.e("chunk-0c346784")]).then(t.bind(null,"ecfa"))}},{path:"/email-verification",name:"emailVerification",component:function(){return Promise.all([t.e("chunk-a1b665b8"),t.e("chunk-8956f106")]).then(t.bind(null,"cf2d"))},meta:{requiresAuth:!0}},{path:"/fill-your-profile-info",name:"fillYourProfileInfo",component:function(){return Promise.all([t.e("chunk-622f8ab8"),t.e("chunk-a1b665b8"),t.e("chunk-7db6e6a6"),t.e("chunk-1dcec364"),t.e("chunk-2939ac1d")]).then(t.bind(null,"5bae"))},meta:{requiresAuth:!0}},{path:"/fill-your-languages",name:"fillYourLanguages",component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-7db6e6a6"),t.e("chunk-1dcec364"),t.e("chunk-4b03be8b")]).then(t.bind(null,"68a4"))},meta:{requiresAuth:!0}},{path:"/set-your-profile-image",name:"setYourProfileImage",component:function(){return t.e("chunk-118d6538").then(t.bind(null,"57e4"))},meta:{requiresAuth:!0}},{path:"/send-change-password-email",name:"sendChangePasswordEmail",component:function(){return Promise.all([t.e("chunk-622f8ab8"),t.e("chunk-a1b665b8"),t.e("chunk-0a1d012c")]).then(t.bind(null,"ff17"))},meta:{requiresAuth:!1}},{path:"/dashboard",name:"dashboard",redirect:{name:"profileHome"},meta:{requiresAuth:!0},component:function(){return t.e("chunk-21399466").then(t.bind(null,"7277"))},children:[{path:"ranking",name:"rankingHome",meta:{requiresAuth:!0,menu:"ranking"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-01635386")]).then(t.bind(null,"185c"))}},{path:"ranking/user/:id/",name:"userProfileRanking",meta:{requiresAuth:!0,menu:"ranking"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-a1b665b8"),t.e("chunk-53e063b5")]).then(t.bind(null,"4a39"))}},{path:"events",name:"eventsHome",meta:{requiresAuth:!0,menu:"events"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-7db6e6a6"),t.e("chunk-1dcec364"),t.e("chunk-797e9352")]).then(t.bind(null,"a58d"))}},{path:"event/:id/",name:"eventDescription",meta:{requiresAuth:!0,menu:"events"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-d7d1cc78")]).then(t.bind(null,"2616"))}},{path:"search",name:"searchHome",meta:{requiresAuth:!0,menu:"search"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-aa931dea")]).then(t.bind(null,"c649"))}},{path:"search/filter",name:"searchFilter",meta:{requiresAuth:!0,menu:"search"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-7db6e6a6"),t.e("chunk-1dcec364"),t.e("chunk-2d258260")]).then(t.bind(null,"c3bc"))}},{path:"search/user/:id/",name:"userProfileSearch",meta:{requiresAuth:!0,menu:"search"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-a1b665b8"),t.e("chunk-53e063b5")]).then(t.bind(null,"4a39"))}},{path:"chats",name:"chatHome",meta:{requiresAuth:!0,menu:"chats"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-7db6e6a6"),t.e("chunk-04be79f4")]).then(t.bind(null,"cc6f"))}},{path:"chats/chat/:id/",name:"chatWithUser",meta:{requiresAuth:!0,menu:"chats"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-68580884")]).then(t.bind(null,"f935"))}},{path:"chats/user/:id/",name:"userProfileChat",meta:{requiresAuth:!0,menu:"chats"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-a1b665b8"),t.e("chunk-53e063b5")]).then(t.bind(null,"4a39"))}},{path:"profile",name:"profileHome",meta:{requiresAuth:!0,menu:"profile"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-a1b665b8"),t.e("chunk-21f06558")]).then(t.bind(null,"7859"))}},{path:"profile/:id/edit",name:"profileEdit",meta:{requiresAuth:!0,menu:"profile"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-a1b665b8"),t.e("chunk-7db6e6a6"),t.e("chunk-56a2defe")]).then(t.bind(null,"358e"))}},{path:"settings",name:"settings",meta:{requiresAuth:!0,menu:"profile"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-a1b665b8"),t.e("chunk-7db6e6a6"),t.e("chunk-6872e3c0")]).then(t.bind(null,"cb04"))}},{path:"settings/account",name:"settingsAccount",meta:{requiresAuth:!0,menu:"profile"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-7db6e6a6"),t.e("chunk-1cf5cb4e")]).then(t.bind(null,"a9a0"))}},{path:"settings/account/edit/name-and-last-name",name:"settingsAccountEditNameAndLastName",meta:{requiresAuth:!0,menu:"profile"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-5cab18be")]).then(t.bind(null,"be3f"))}},{path:"settings/account/edit/email",name:"settingsAccountEditEmail",meta:{requiresAuth:!0,menu:"profile"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-a1b665b8"),t.e("chunk-e2d880e8")]).then(t.bind(null,"4c98"))}},{path:"settings/account/password-verification",name:"settingsAccountPasswordVerification",meta:{requiresAuth:!0,menu:"profile"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-2733c950")]).then(t.bind(null,"71cb"))}},{path:"settings/account/edit/password",name:"settingsAccountEditPassword",meta:{requiresAuth:!0,menu:"profile"},component:function(){return Promise.all([t.e("chunk-3179424c"),t.e("chunk-622f8ab8"),t.e("chunk-a1b665b8"),t.e("chunk-116beaae")]).then(t.bind(null,"6e40"))}}]}]});ae.beforeEach((function(e,n,t){var a=u.a.auth().currentUser,r=e.matched.some((function(e){return e.meta.requiresAuth}));r&&!a?t("home"):r&&a&&e.name!==n.name&&(!e.path.startsWith("/dashboard")||!n.path.startsWith("/dashboard"))||!r&&a?te.dispatch("user/getRegistrationState").then((function(a){e.path.startsWith("/"+a)?t():n.path.startsWith("/"+a)?t({name:n.name}):t({path:"/"+a})})):t()}));var re=ae,se=t("9483");Object(se["a"])("".concat("/","firebase-messaging-sw.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var oe=t("f309");a["a"].use(oe["a"]);var ie=new oe["a"]({icons:{iconfont:"mdi"},theme:{light:{primary:"#1976D2",secondary:"#424242",accent:"#82B1FF",error:"#FF5252",info:"#2196F3",success:"#4CAF50",warning:"#FFC107"}}}),ce=t("123d"),ue=t.n(ce),le=t("c9d0"),fe=t.n(le),ge=t("755e");a["a"].use(ue.a),a["a"].use(fe.a),a["a"].use(ge,{load:{key:"AIzaSyBYhPYAZkG6ML2kRArdK8xITPrZWzF0JSw",libraries:"places"}}),a["a"].config.productionTip=!1;var he="",de={apiKey:"AIzaSyABGil2afckXxQ127FS8fW6y5phy1wzd6g",authDomain:"tfg-vue-m3m.firebaseapp.com",databaseURL:"https://tfg-vue-m3m.firebaseio.com",projectId:"tfg-vue-m3m",storageBucket:"tfg-vue-m3m.appspot.com",messagingSenderId:"144506012173",appId:"1:144506012173:web:8a58aa4b50d8b336184b44"};u.a.initializeApp(de);var me=u.a.firestore();me.settings({timestampsInSnapshots:!0}),me.enablePersistence({experimentalTabSynchronization:!0});var Ee=u.a.storage(),Ie=u.a.messaging();n["default"]={db:me,storage:Ee,messaging:Ie};u.a.auth().onAuthStateChanged((function(){he||(he=new a["a"]({router:re,store:te,vuetify:ie,render:function(e){return e(p)}}).$mount("#app"))}))},ccd6:function(e,n,t){},cf05:function(e,n,t){e.exports=t.p+"img/logo.82b9c7a5.png"},d903:function(e,n,t){"use strict";var a=t("ccd6"),r=t.n(a);r.a}});
//# sourceMappingURL=app.125184a4.js.map